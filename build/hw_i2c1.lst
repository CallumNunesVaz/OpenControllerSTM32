ARM GAS  /tmp/cch08t2F.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"hw_i2c1.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.i2c1_reset,"ax",%progbits
  18              		.align	1
  19              		.global	i2c1_reset
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	i2c1_reset:
  25              	.LFB66:
  26              		.file 1 "Core/Src/hw_i2c1.c"
   1:Core/Src/hw_i2c1.c **** /* USER CODE BEGIN Header */
   2:Core/Src/hw_i2c1.c **** /**
   3:Core/Src/hw_i2c1.c ****  ******************************************************************************
   4:Core/Src/hw_i2c1.c ****  * @file           : main.c
   5:Core/Src/hw_i2c1.c ****  * @brief          : Main program body
   6:Core/Src/hw_i2c1.c ****  ******************************************************************************
   7:Core/Src/hw_i2c1.c ****  * @attention
   8:Core/Src/hw_i2c1.c ****  *
   9:Core/Src/hw_i2c1.c ****  * <h2><center>&copy; Copyright (c) 2022 STMicroelectronics.
  10:Core/Src/hw_i2c1.c ****  * All rights reserved.</center></h2>
  11:Core/Src/hw_i2c1.c ****  *
  12:Core/Src/hw_i2c1.c ****  * This software component is licensed by ST under BSD 3-Clause license,
  13:Core/Src/hw_i2c1.c ****  * the "License"; You may not use this file except in compliance with the
  14:Core/Src/hw_i2c1.c ****  * License. You may obtain a copy of the License at:
  15:Core/Src/hw_i2c1.c ****  *                        opensource.org/licenses/BSD-3-Clause
  16:Core/Src/hw_i2c1.c ****  *
  17:Core/Src/hw_i2c1.c ****  ******************************************************************************
  18:Core/Src/hw_i2c1.c ****  */
  19:Core/Src/hw_i2c1.c **** /* USER CODE END Header */
  20:Core/Src/hw_i2c1.c **** /* Includes ------------------------------------------------------------------*/
  21:Core/Src/hw_i2c1.c **** #include "hw_i2c1.h"
  22:Core/Src/hw_i2c1.c **** 
  23:Core/Src/hw_i2c1.c **** // https://controllerstech.com/stm32-i2c-configuration-using-registers/
  24:Core/Src/hw_i2c1.c **** 
  25:Core/Src/hw_i2c1.c **** /* buffer data storage and buffer handlers */
  26:Core/Src/hw_i2c1.c **** static buffer_t buf_tx;
  27:Core/Src/hw_i2c1.c **** static buffer_t buf_rx;
  28:Core/Src/hw_i2c1.c **** static uint8_t buf_tx_data[BUF_TX_LEN];
  29:Core/Src/hw_i2c1.c **** static uint8_t buf_rx_data[BUF_RX_LEN];
  30:Core/Src/hw_i2c1.c **** 
  31:Core/Src/hw_i2c1.c **** /* GPIO handlers */
  32:Core/Src/hw_i2c1.c **** static stmgpio_t *i2c1_scl;
ARM GAS  /tmp/cch08t2F.s 			page 2


  33:Core/Src/hw_i2c1.c **** static stmgpio_t *i2c1_sda;
  34:Core/Src/hw_i2c1.c **** 
  35:Core/Src/hw_i2c1.c **** bool i2c1_init(void)
  36:Core/Src/hw_i2c1.c **** {
  37:Core/Src/hw_i2c1.c ****   /* We only need these during init */
  38:Core/Src/hw_i2c1.c ****   stmgpio_setup_t i2c1_scl_setup;
  39:Core/Src/hw_i2c1.c ****   stmgpio_setup_t i2c1_sda_setup;
  40:Core/Src/hw_i2c1.c **** 
  41:Core/Src/hw_i2c1.c ****   /* Initialise buffers */
  42:Core/Src/hw_i2c1.c ****   buf_init(&buf_tx, buf_tx_data, sizeof(buf_tx_data));
  43:Core/Src/hw_i2c1.c ****   buf_init(&buf_rx, buf_rx_data, sizeof(buf_rx_data));
  44:Core/Src/hw_i2c1.c **** 
  45:Core/Src/hw_i2c1.c ****   /* Enable the I2C1 clock */
  46:Core/Src/hw_i2c1.c ****   RCC->APB1ENR |= RCC_APB1ENR_I2C1EN;
  47:Core/Src/hw_i2c1.c **** 
  48:Core/Src/hw_i2c1.c ****   /* USING PB8 and PB9, so enable port B clock if not already */
  49:Core/Src/hw_i2c1.c ****   RCC->APB2ENR |= RCC_APB2ENR_IOPBEN;
  50:Core/Src/hw_i2c1.c **** 
  51:Core/Src/hw_i2c1.c ****   /* Setup the GPIO pins */
  52:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.port = I2C_SCL_PORT;
  53:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pin = I2C_SCL_PIN;
  54:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.cfg = OUT_ALT_OPENDRAIN;
  55:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.dir = OUTPUT_10MHZ;
  56:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pull = PULLUP;
  57:Core/Src/hw_i2c1.c ****   i2c1_scl = stmgpio_setup_gpio(&i2c1_scl_setup);
  58:Core/Src/hw_i2c1.c **** 
  59:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.port = I2C_SDA_PORT;
  60:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pin = I2C_SDA_PIN;
  61:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.cfg = OUT_ALT_OPENDRAIN;
  62:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.dir = OUTPUT_10MHZ;
  63:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pull = PULLUP;
  64:Core/Src/hw_i2c1.c ****   i2c1_sda = stmgpio_setup_gpio(&i2c1_sda_setup);
  65:Core/Src/hw_i2c1.c **** 
  66:Core/Src/hw_i2c1.c ****   /* Set the pin remap for i2c1 */
  67:Core/Src/hw_i2c1.c ****   AFIO->MAPR |= AFIO_MAPR_I2C1_REMAP;
  68:Core/Src/hw_i2c1.c **** 
  69:Core/Src/hw_i2c1.c ****   /* Disable i2c1 peripheral to apply settings */
  70:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_PE;
  71:Core/Src/hw_i2c1.c **** 
  72:Core/Src/hw_i2c1.c ****   /* Disable clock stretching */
  73:Core/Src/hw_i2c1.c ****   I2C1->CR1 |= I2C_CR1_NOSTRETCH;
  74:Core/Src/hw_i2c1.c **** 
  75:Core/Src/hw_i2c1.c ****   /* Disable general call */
  76:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_ENGC;
  77:Core/Src/hw_i2c1.c **** 
  78:Core/Src/hw_i2c1.c ****   /* Disable SMBUS. Using I2C */
  79:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_SMBUS;
  80:Core/Src/hw_i2c1.c **** 
  81:Core/Src/hw_i2c1.c ****   /* Disable DMA */
  82:Core/Src/hw_i2c1.c ****   I2C1->CR2 &= ~I2C_CR2_DMAEN;
  83:Core/Src/hw_i2c1.c **** 
  84:Core/Src/hw_i2c1.c ****   /* Enable DMA TX buffer interrupt */
  85:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= I2C_CR2_ITBUFEN;
  86:Core/Src/hw_i2c1.c **** 
  87:Core/Src/hw_i2c1.c ****   /* Enable event interrupt */
  88:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= I2C_CR2_ITEVTEN;
  89:Core/Src/hw_i2c1.c **** 
ARM GAS  /tmp/cch08t2F.s 			page 3


  90:Core/Src/hw_i2c1.c ****   /* Enable error interrupt */
  91:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= I2C_CR2_ITERREN;
  92:Core/Src/hw_i2c1.c **** 
  93:Core/Src/hw_i2c1.c ****   /* Inform of APB bus frequency */
  94:Core/Src/hw_i2c1.c ****   I2C1->CR2 &= ~I2C_CR2_FREQ;
  95:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= APB_BUS_FREQ_MHZ;
  96:Core/Src/hw_i2c1.c **** 
  97:Core/Src/hw_i2c1.c ****   /* Set to standard mode */
  98:Core/Src/hw_i2c1.c ****   I2C1->CCR &= ~I2C_CCR_FS;
  99:Core/Src/hw_i2c1.c **** 
 100:Core/Src/hw_i2c1.c ****   /* Set clock for 100kHz */
 101:Core/Src/hw_i2c1.c ****   I2C1->CCR &= ~I2C_CCR_CCR;
 102:Core/Src/hw_i2c1.c ****   I2C1->CCR |= 250;
 103:Core/Src/hw_i2c1.c **** 
 104:Core/Src/hw_i2c1.c ****   /* Set rise time for 1000ns */
 105:Core/Src/hw_i2c1.c ****   I2C1->TRISE &= ~I2C_TRISE_TRISE;
 106:Core/Src/hw_i2c1.c ****   I2C1->TRISE |= 50;
 107:Core/Src/hw_i2c1.c **** 
 108:Core/Src/hw_i2c1.c ****   /* Enable i2c1 peripheral */
 109:Core/Src/hw_i2c1.c ****   I2C1->CR1 |= I2C_CR1_PE;
 110:Core/Src/hw_i2c1.c **** 
 111:Core/Src/hw_i2c1.c ****   /* Trigger reset before first usage */
 112:Core/Src/hw_i2c1.c ****   i2c1_reset();
 113:Core/Src/hw_i2c1.c **** 
 114:Core/Src/hw_i2c1.c ****   return EXIT_SUCCESS;
 115:Core/Src/hw_i2c1.c **** }
 116:Core/Src/hw_i2c1.c **** 
 117:Core/Src/hw_i2c1.c **** void i2c1_reset(void)
 118:Core/Src/hw_i2c1.c **** {
  27              		.loc 1 118 1 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
 119:Core/Src/hw_i2c1.c ****   I2C1->CR1 |= I2C_CR1_SWRST;
  32              		.loc 1 119 3 view .LVU1
  33              		.loc 1 119 13 is_stmt 0 view .LVU2
  34 0000 044B     		ldr	r3, .L2
  35 0002 1A68     		ldr	r2, [r3]
  36 0004 42F40042 		orr	r2, r2, #32768
  37 0008 1A60     		str	r2, [r3]
 120:Core/Src/hw_i2c1.c ****   // make sure the I2C lines are released and the bus is free
 121:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_SWRST;
  38              		.loc 1 121 3 is_stmt 1 view .LVU3
  39              		.loc 1 121 13 is_stmt 0 view .LVU4
  40 000a 1A68     		ldr	r2, [r3]
  41 000c 22F40042 		bic	r2, r2, #32768
  42 0010 1A60     		str	r2, [r3]
 122:Core/Src/hw_i2c1.c **** }
  43              		.loc 1 122 1 view .LVU5
  44 0012 7047     		bx	lr
  45              	.L3:
  46              		.align	2
  47              	.L2:
  48 0014 00540040 		.word	1073763328
  49              		.cfi_endproc
  50              	.LFE66:
ARM GAS  /tmp/cch08t2F.s 			page 4


  52              		.section	.text.i2c1_init,"ax",%progbits
  53              		.align	1
  54              		.global	i2c1_init
  55              		.syntax unified
  56              		.thumb
  57              		.thumb_func
  59              	i2c1_init:
  60              	.LFB65:
  36:Core/Src/hw_i2c1.c ****   /* We only need these during init */
  61              		.loc 1 36 1 is_stmt 1 view -0
  62              		.cfi_startproc
  63              		@ args = 0, pretend = 0, frame = 16
  64              		@ frame_needed = 0, uses_anonymous_args = 0
  65 0000 70B5     		push	{r4, r5, r6, lr}
  66              	.LCFI0:
  67              		.cfi_def_cfa_offset 16
  68              		.cfi_offset 4, -16
  69              		.cfi_offset 5, -12
  70              		.cfi_offset 6, -8
  71              		.cfi_offset 14, -4
  72 0002 84B0     		sub	sp, sp, #16
  73              	.LCFI1:
  74              		.cfi_def_cfa_offset 32
  38:Core/Src/hw_i2c1.c ****   stmgpio_setup_t i2c1_sda_setup;
  75              		.loc 1 38 3 view .LVU7
  39:Core/Src/hw_i2c1.c **** 
  76              		.loc 1 39 3 view .LVU8
  42:Core/Src/hw_i2c1.c ****   buf_init(&buf_rx, buf_rx_data, sizeof(buf_rx_data));
  77              		.loc 1 42 3 view .LVU9
  78 0004 FF22     		movs	r2, #255
  79 0006 4149     		ldr	r1, .L6
  80 0008 4148     		ldr	r0, .L6+4
  81 000a FFF7FEFF 		bl	buf_init
  82              	.LVL0:
  43:Core/Src/hw_i2c1.c **** 
  83              		.loc 1 43 3 view .LVU10
  84 000e FF22     		movs	r2, #255
  85 0010 4049     		ldr	r1, .L6+8
  86 0012 4148     		ldr	r0, .L6+12
  87 0014 FFF7FEFF 		bl	buf_init
  88              	.LVL1:
  46:Core/Src/hw_i2c1.c **** 
  89              		.loc 1 46 3 view .LVU11
  46:Core/Src/hw_i2c1.c **** 
  90              		.loc 1 46 16 is_stmt 0 view .LVU12
  91 0018 404B     		ldr	r3, .L6+16
  92 001a DA69     		ldr	r2, [r3, #28]
  93 001c 42F40012 		orr	r2, r2, #2097152
  94 0020 DA61     		str	r2, [r3, #28]
  49:Core/Src/hw_i2c1.c **** 
  95              		.loc 1 49 3 is_stmt 1 view .LVU13
  49:Core/Src/hw_i2c1.c **** 
  96              		.loc 1 49 16 is_stmt 0 view .LVU14
  97 0022 9A69     		ldr	r2, [r3, #24]
  98 0024 42F00802 		orr	r2, r2, #8
  99 0028 9A61     		str	r2, [r3, #24]
  52:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pin = I2C_SCL_PIN;
ARM GAS  /tmp/cch08t2F.s 			page 5


 100              		.loc 1 52 3 is_stmt 1 view .LVU15
  52:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pin = I2C_SCL_PIN;
 101              		.loc 1 52 23 is_stmt 0 view .LVU16
 102 002a 4226     		movs	r6, #66
 103 002c 8DF80B60 		strb	r6, [sp, #11]
  53:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.cfg = OUT_ALT_OPENDRAIN;
 104              		.loc 1 53 3 is_stmt 1 view .LVU17
  53:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.cfg = OUT_ALT_OPENDRAIN;
 105              		.loc 1 53 22 is_stmt 0 view .LVU18
 106 0030 0823     		movs	r3, #8
 107 0032 8DF80C30 		strb	r3, [sp, #12]
  54:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.dir = OUTPUT_10MHZ;
 108              		.loc 1 54 3 is_stmt 1 view .LVU19
  54:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.dir = OUTPUT_10MHZ;
 109              		.loc 1 54 22 is_stmt 0 view .LVU20
 110 0036 0725     		movs	r5, #7
 111 0038 8DF80950 		strb	r5, [sp, #9]
  55:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pull = PULLUP;
 112              		.loc 1 55 3 is_stmt 1 view .LVU21
  55:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pull = PULLUP;
 113              		.loc 1 55 22 is_stmt 0 view .LVU22
 114 003c 0124     		movs	r4, #1
 115 003e 8DF80840 		strb	r4, [sp, #8]
  56:Core/Src/hw_i2c1.c ****   i2c1_scl = stmgpio_setup_gpio(&i2c1_scl_setup);
 116              		.loc 1 56 3 is_stmt 1 view .LVU23
  56:Core/Src/hw_i2c1.c ****   i2c1_scl = stmgpio_setup_gpio(&i2c1_scl_setup);
 117              		.loc 1 56 23 is_stmt 0 view .LVU24
 118 0042 8DF80A40 		strb	r4, [sp, #10]
  57:Core/Src/hw_i2c1.c **** 
 119              		.loc 1 57 3 is_stmt 1 view .LVU25
  57:Core/Src/hw_i2c1.c **** 
 120              		.loc 1 57 14 is_stmt 0 view .LVU26
 121 0046 0DEB0300 		add	r0, sp, r3
 122 004a FFF7FEFF 		bl	stmgpio_setup_gpio
 123              	.LVL2:
  57:Core/Src/hw_i2c1.c **** 
 124              		.loc 1 57 12 view .LVU27
 125 004e 344B     		ldr	r3, .L6+20
 126 0050 1860     		str	r0, [r3]
  59:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pin = I2C_SDA_PIN;
 127              		.loc 1 59 3 is_stmt 1 view .LVU28
  59:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pin = I2C_SDA_PIN;
 128              		.loc 1 59 23 is_stmt 0 view .LVU29
 129 0052 8DF80360 		strb	r6, [sp, #3]
  60:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.cfg = OUT_ALT_OPENDRAIN;
 130              		.loc 1 60 3 is_stmt 1 view .LVU30
  60:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.cfg = OUT_ALT_OPENDRAIN;
 131              		.loc 1 60 22 is_stmt 0 view .LVU31
 132 0056 0923     		movs	r3, #9
 133 0058 8DF80430 		strb	r3, [sp, #4]
  61:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.dir = OUTPUT_10MHZ;
 134              		.loc 1 61 3 is_stmt 1 view .LVU32
  61:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.dir = OUTPUT_10MHZ;
 135              		.loc 1 61 22 is_stmt 0 view .LVU33
 136 005c 8DF80150 		strb	r5, [sp, #1]
  62:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pull = PULLUP;
 137              		.loc 1 62 3 is_stmt 1 view .LVU34
ARM GAS  /tmp/cch08t2F.s 			page 6


  62:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pull = PULLUP;
 138              		.loc 1 62 22 is_stmt 0 view .LVU35
 139 0060 8DF80040 		strb	r4, [sp]
  63:Core/Src/hw_i2c1.c ****   i2c1_sda = stmgpio_setup_gpio(&i2c1_sda_setup);
 140              		.loc 1 63 3 is_stmt 1 view .LVU36
  63:Core/Src/hw_i2c1.c ****   i2c1_sda = stmgpio_setup_gpio(&i2c1_sda_setup);
 141              		.loc 1 63 23 is_stmt 0 view .LVU37
 142 0064 8DF80240 		strb	r4, [sp, #2]
  64:Core/Src/hw_i2c1.c **** 
 143              		.loc 1 64 3 is_stmt 1 view .LVU38
  64:Core/Src/hw_i2c1.c **** 
 144              		.loc 1 64 14 is_stmt 0 view .LVU39
 145 0068 6846     		mov	r0, sp
 146 006a FFF7FEFF 		bl	stmgpio_setup_gpio
 147              	.LVL3:
  64:Core/Src/hw_i2c1.c **** 
 148              		.loc 1 64 12 view .LVU40
 149 006e 2D4B     		ldr	r3, .L6+24
 150 0070 1860     		str	r0, [r3]
  67:Core/Src/hw_i2c1.c **** 
 151              		.loc 1 67 3 is_stmt 1 view .LVU41
  67:Core/Src/hw_i2c1.c **** 
 152              		.loc 1 67 14 is_stmt 0 view .LVU42
 153 0072 2D4A     		ldr	r2, .L6+28
 154 0074 5368     		ldr	r3, [r2, #4]
 155 0076 43F00203 		orr	r3, r3, #2
 156 007a 5360     		str	r3, [r2, #4]
  70:Core/Src/hw_i2c1.c **** 
 157              		.loc 1 70 3 is_stmt 1 view .LVU43
  70:Core/Src/hw_i2c1.c **** 
 158              		.loc 1 70 13 is_stmt 0 view .LVU44
 159 007c 2B4B     		ldr	r3, .L6+32
 160 007e 1A68     		ldr	r2, [r3]
 161 0080 22F00102 		bic	r2, r2, #1
 162 0084 1A60     		str	r2, [r3]
  73:Core/Src/hw_i2c1.c **** 
 163              		.loc 1 73 3 is_stmt 1 view .LVU45
  73:Core/Src/hw_i2c1.c **** 
 164              		.loc 1 73 13 is_stmt 0 view .LVU46
 165 0086 1A68     		ldr	r2, [r3]
 166 0088 42F08002 		orr	r2, r2, #128
 167 008c 1A60     		str	r2, [r3]
  76:Core/Src/hw_i2c1.c **** 
 168              		.loc 1 76 3 is_stmt 1 view .LVU47
  76:Core/Src/hw_i2c1.c **** 
 169              		.loc 1 76 13 is_stmt 0 view .LVU48
 170 008e 1A68     		ldr	r2, [r3]
 171 0090 22F04002 		bic	r2, r2, #64
 172 0094 1A60     		str	r2, [r3]
  79:Core/Src/hw_i2c1.c **** 
 173              		.loc 1 79 3 is_stmt 1 view .LVU49
  79:Core/Src/hw_i2c1.c **** 
 174              		.loc 1 79 13 is_stmt 0 view .LVU50
 175 0096 1A68     		ldr	r2, [r3]
 176 0098 22F00202 		bic	r2, r2, #2
 177 009c 1A60     		str	r2, [r3]
  82:Core/Src/hw_i2c1.c **** 
ARM GAS  /tmp/cch08t2F.s 			page 7


 178              		.loc 1 82 3 is_stmt 1 view .LVU51
  82:Core/Src/hw_i2c1.c **** 
 179              		.loc 1 82 13 is_stmt 0 view .LVU52
 180 009e 5A68     		ldr	r2, [r3, #4]
 181 00a0 22F40062 		bic	r2, r2, #2048
 182 00a4 5A60     		str	r2, [r3, #4]
  85:Core/Src/hw_i2c1.c **** 
 183              		.loc 1 85 3 is_stmt 1 view .LVU53
  85:Core/Src/hw_i2c1.c **** 
 184              		.loc 1 85 13 is_stmt 0 view .LVU54
 185 00a6 5A68     		ldr	r2, [r3, #4]
 186 00a8 42F48062 		orr	r2, r2, #1024
 187 00ac 5A60     		str	r2, [r3, #4]
  88:Core/Src/hw_i2c1.c **** 
 188              		.loc 1 88 3 is_stmt 1 view .LVU55
  88:Core/Src/hw_i2c1.c **** 
 189              		.loc 1 88 13 is_stmt 0 view .LVU56
 190 00ae 5A68     		ldr	r2, [r3, #4]
 191 00b0 42F40072 		orr	r2, r2, #512
 192 00b4 5A60     		str	r2, [r3, #4]
  91:Core/Src/hw_i2c1.c **** 
 193              		.loc 1 91 3 is_stmt 1 view .LVU57
  91:Core/Src/hw_i2c1.c **** 
 194              		.loc 1 91 13 is_stmt 0 view .LVU58
 195 00b6 5A68     		ldr	r2, [r3, #4]
 196 00b8 42F48072 		orr	r2, r2, #256
 197 00bc 5A60     		str	r2, [r3, #4]
  94:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= APB_BUS_FREQ_MHZ;
 198              		.loc 1 94 3 is_stmt 1 view .LVU59
  94:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= APB_BUS_FREQ_MHZ;
 199              		.loc 1 94 13 is_stmt 0 view .LVU60
 200 00be 5A68     		ldr	r2, [r3, #4]
 201 00c0 22F03F02 		bic	r2, r2, #63
 202 00c4 5A60     		str	r2, [r3, #4]
  95:Core/Src/hw_i2c1.c **** 
 203              		.loc 1 95 3 is_stmt 1 view .LVU61
  95:Core/Src/hw_i2c1.c **** 
 204              		.loc 1 95 13 is_stmt 0 view .LVU62
 205 00c6 5A68     		ldr	r2, [r3, #4]
 206 00c8 42F03202 		orr	r2, r2, #50
 207 00cc 5A60     		str	r2, [r3, #4]
  98:Core/Src/hw_i2c1.c **** 
 208              		.loc 1 98 3 is_stmt 1 view .LVU63
  98:Core/Src/hw_i2c1.c **** 
 209              		.loc 1 98 13 is_stmt 0 view .LVU64
 210 00ce DA69     		ldr	r2, [r3, #28]
 211 00d0 22F40042 		bic	r2, r2, #32768
 212 00d4 DA61     		str	r2, [r3, #28]
 101:Core/Src/hw_i2c1.c ****   I2C1->CCR |= 250;
 213              		.loc 1 101 3 is_stmt 1 view .LVU65
 101:Core/Src/hw_i2c1.c ****   I2C1->CCR |= 250;
 214              		.loc 1 101 13 is_stmt 0 view .LVU66
 215 00d6 DA69     		ldr	r2, [r3, #28]
 216 00d8 22F47F62 		bic	r2, r2, #4080
 217 00dc 22F00F02 		bic	r2, r2, #15
 218 00e0 DA61     		str	r2, [r3, #28]
 102:Core/Src/hw_i2c1.c **** 
ARM GAS  /tmp/cch08t2F.s 			page 8


 219              		.loc 1 102 3 is_stmt 1 view .LVU67
 102:Core/Src/hw_i2c1.c **** 
 220              		.loc 1 102 13 is_stmt 0 view .LVU68
 221 00e2 DA69     		ldr	r2, [r3, #28]
 222 00e4 42F0FA02 		orr	r2, r2, #250
 223 00e8 DA61     		str	r2, [r3, #28]
 105:Core/Src/hw_i2c1.c ****   I2C1->TRISE |= 50;
 224              		.loc 1 105 3 is_stmt 1 view .LVU69
 105:Core/Src/hw_i2c1.c ****   I2C1->TRISE |= 50;
 225              		.loc 1 105 15 is_stmt 0 view .LVU70
 226 00ea 1A6A     		ldr	r2, [r3, #32]
 227 00ec 22F03F02 		bic	r2, r2, #63
 228 00f0 1A62     		str	r2, [r3, #32]
 106:Core/Src/hw_i2c1.c **** 
 229              		.loc 1 106 3 is_stmt 1 view .LVU71
 106:Core/Src/hw_i2c1.c **** 
 230              		.loc 1 106 15 is_stmt 0 view .LVU72
 231 00f2 1A6A     		ldr	r2, [r3, #32]
 232 00f4 42F03202 		orr	r2, r2, #50
 233 00f8 1A62     		str	r2, [r3, #32]
 109:Core/Src/hw_i2c1.c **** 
 234              		.loc 1 109 3 is_stmt 1 view .LVU73
 109:Core/Src/hw_i2c1.c **** 
 235              		.loc 1 109 13 is_stmt 0 view .LVU74
 236 00fa 1A68     		ldr	r2, [r3]
 237 00fc 2243     		orrs	r2, r2, r4
 238 00fe 1A60     		str	r2, [r3]
 112:Core/Src/hw_i2c1.c **** 
 239              		.loc 1 112 3 is_stmt 1 view .LVU75
 240 0100 FFF7FEFF 		bl	i2c1_reset
 241              	.LVL4:
 114:Core/Src/hw_i2c1.c **** }
 242              		.loc 1 114 3 view .LVU76
 115:Core/Src/hw_i2c1.c **** 
 243              		.loc 1 115 1 is_stmt 0 view .LVU77
 244 0104 0020     		movs	r0, #0
 245 0106 04B0     		add	sp, sp, #16
 246              	.LCFI2:
 247              		.cfi_def_cfa_offset 16
 248              		@ sp needed
 249 0108 70BD     		pop	{r4, r5, r6, pc}
 250              	.L7:
 251 010a 00BF     		.align	2
 252              	.L6:
 253 010c 00000000 		.word	.LANCHOR0
 254 0110 00000000 		.word	.LANCHOR1
 255 0114 00000000 		.word	.LANCHOR2
 256 0118 00000000 		.word	.LANCHOR3
 257 011c 00100240 		.word	1073876992
 258 0120 00000000 		.word	.LANCHOR4
 259 0124 00000000 		.word	.LANCHOR5
 260 0128 00000140 		.word	1073807360
 261 012c 00540040 		.word	1073763328
 262              		.cfi_endproc
 263              	.LFE65:
 265              		.section	.text.i2c1_enable,"ax",%progbits
 266              		.align	1
ARM GAS  /tmp/cch08t2F.s 			page 9


 267              		.global	i2c1_enable
 268              		.syntax unified
 269              		.thumb
 270              		.thumb_func
 272              	i2c1_enable:
 273              	.LFB67:
 123:Core/Src/hw_i2c1.c **** 
 124:Core/Src/hw_i2c1.c **** void i2c1_enable(void)
 125:Core/Src/hw_i2c1.c **** {
 274              		.loc 1 125 1 is_stmt 1 view -0
 275              		.cfi_startproc
 276              		@ args = 0, pretend = 0, frame = 0
 277              		@ frame_needed = 0, uses_anonymous_args = 0
 278              		@ link register save eliminated.
 126:Core/Src/hw_i2c1.c ****   I2C1->CR1 |= I2C_CR1_PE;
 279              		.loc 1 126 3 view .LVU79
 280              		.loc 1 126 13 is_stmt 0 view .LVU80
 281 0000 024A     		ldr	r2, .L9
 282 0002 1368     		ldr	r3, [r2]
 283 0004 43F00103 		orr	r3, r3, #1
 284 0008 1360     		str	r3, [r2]
 127:Core/Src/hw_i2c1.c **** }
 285              		.loc 1 127 1 view .LVU81
 286 000a 7047     		bx	lr
 287              	.L10:
 288              		.align	2
 289              	.L9:
 290 000c 00540040 		.word	1073763328
 291              		.cfi_endproc
 292              	.LFE67:
 294              		.section	.text.i2c1_disable,"ax",%progbits
 295              		.align	1
 296              		.global	i2c1_disable
 297              		.syntax unified
 298              		.thumb
 299              		.thumb_func
 301              	i2c1_disable:
 302              	.LFB68:
 128:Core/Src/hw_i2c1.c **** 
 129:Core/Src/hw_i2c1.c **** void i2c1_disable(void)
 130:Core/Src/hw_i2c1.c **** {
 303              		.loc 1 130 1 is_stmt 1 view -0
 304              		.cfi_startproc
 305              		@ args = 0, pretend = 0, frame = 0
 306              		@ frame_needed = 0, uses_anonymous_args = 0
 307              		@ link register save eliminated.
 131:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_PE;
 308              		.loc 1 131 3 view .LVU83
 309              		.loc 1 131 13 is_stmt 0 view .LVU84
 310 0000 024A     		ldr	r2, .L12
 311 0002 1368     		ldr	r3, [r2]
 312 0004 23F00103 		bic	r3, r3, #1
 313 0008 1360     		str	r3, [r2]
 132:Core/Src/hw_i2c1.c **** }
 314              		.loc 1 132 1 view .LVU85
 315 000a 7047     		bx	lr
 316              	.L13:
ARM GAS  /tmp/cch08t2F.s 			page 10


 317              		.align	2
 318              	.L12:
 319 000c 00540040 		.word	1073763328
 320              		.cfi_endproc
 321              	.LFE68:
 323              		.section	.text.i2c1_read_byte,"ax",%progbits
 324              		.align	1
 325              		.global	i2c1_read_byte
 326              		.syntax unified
 327              		.thumb
 328              		.thumb_func
 330              	i2c1_read_byte:
 331              	.LFB69:
 133:Core/Src/hw_i2c1.c **** 
 134:Core/Src/hw_i2c1.c **** uint8_t i2c1_read_byte(void)
 135:Core/Src/hw_i2c1.c **** {
 332              		.loc 1 135 1 is_stmt 1 view -0
 333              		.cfi_startproc
 334              		@ args = 0, pretend = 0, frame = 0
 335              		@ frame_needed = 0, uses_anonymous_args = 0
 336              		@ link register save eliminated.
 136:Core/Src/hw_i2c1.c **** }
 337              		.loc 1 136 1 view .LVU87
 338 0000 7047     		bx	lr
 339              		.cfi_endproc
 340              	.LFE69:
 342              		.section	.text.i2c1_read_byte_array,"ax",%progbits
 343              		.align	1
 344              		.global	i2c1_read_byte_array
 345              		.syntax unified
 346              		.thumb
 347              		.thumb_func
 349              	i2c1_read_byte_array:
 350              	.LVL5:
 351              	.LFB70:
 137:Core/Src/hw_i2c1.c **** 
 138:Core/Src/hw_i2c1.c **** void i2c1_read_byte_array(uint8_t *data[], size_t len)
 139:Core/Src/hw_i2c1.c **** {
 352              		.loc 1 139 1 view -0
 353              		.cfi_startproc
 354              		@ args = 0, pretend = 0, frame = 0
 355              		@ frame_needed = 0, uses_anonymous_args = 0
 356              		@ link register save eliminated.
 140:Core/Src/hw_i2c1.c **** }
 357              		.loc 1 140 1 view .LVU89
 358 0000 7047     		bx	lr
 359              		.cfi_endproc
 360              	.LFE70:
 362              		.section	.text.i2c1_write_byte,"ax",%progbits
 363              		.align	1
 364              		.global	i2c1_write_byte
 365              		.syntax unified
 366              		.thumb
 367              		.thumb_func
 369              	i2c1_write_byte:
 370              	.LFB71:
 141:Core/Src/hw_i2c1.c **** 
ARM GAS  /tmp/cch08t2F.s 			page 11


 142:Core/Src/hw_i2c1.c **** void i2c1_write_byte(uint8_t data)
 143:Core/Src/hw_i2c1.c **** {
 371              		.loc 1 143 1 view -0
 372              		.cfi_startproc
 373              		@ args = 0, pretend = 0, frame = 0
 374              		@ frame_needed = 0, uses_anonymous_args = 0
 375              		@ link register save eliminated.
 376              	.LVL6:
 377              	.L17:
 144:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 7)))
 145:Core/Src/hw_i2c1.c ****     ; // wait for TXE bit to set
 378              		.loc 1 145 5 discriminator 1 view .LVU91
 144:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 7)))
 379              		.loc 1 144 9 discriminator 1 view .LVU92
 144:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 7)))
 380              		.loc 1 144 16 is_stmt 0 discriminator 1 view .LVU93
 381 0000 064B     		ldr	r3, .L19
 382 0002 5B69     		ldr	r3, [r3, #20]
 144:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 7)))
 383              		.loc 1 144 9 discriminator 1 view .LVU94
 384 0004 13F0800F 		tst	r3, #128
 385 0008 FAD0     		beq	.L17
 146:Core/Src/hw_i2c1.c **** 
 147:Core/Src/hw_i2c1.c ****   /* Set register bit */
 148:Core/Src/hw_i2c1.c ****   I2C1->DR = data;
 386              		.loc 1 148 3 is_stmt 1 view .LVU95
 387              		.loc 1 148 12 is_stmt 0 view .LVU96
 388 000a 044B     		ldr	r3, .L19
 389 000c 1861     		str	r0, [r3, #16]
 149:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 2)))
 390              		.loc 1 149 3 is_stmt 1 view .LVU97
 391              	.L18:
 150:Core/Src/hw_i2c1.c ****     ; // wait for BTF bit to set
 392              		.loc 1 150 5 discriminator 1 view .LVU98
 149:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 2)))
 393              		.loc 1 149 9 discriminator 1 view .LVU99
 149:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 2)))
 394              		.loc 1 149 16 is_stmt 0 discriminator 1 view .LVU100
 395 000e 034B     		ldr	r3, .L19
 396 0010 5B69     		ldr	r3, [r3, #20]
 149:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 2)))
 397              		.loc 1 149 9 discriminator 1 view .LVU101
 398 0012 13F0040F 		tst	r3, #4
 399 0016 FAD0     		beq	.L18
 151:Core/Src/hw_i2c1.c **** }
 400              		.loc 1 151 1 view .LVU102
 401 0018 7047     		bx	lr
 402              	.L20:
 403 001a 00BF     		.align	2
 404              	.L19:
 405 001c 00540040 		.word	1073763328
 406              		.cfi_endproc
 407              	.LFE71:
 409              		.section	.text.i2c1_write_byte_array,"ax",%progbits
 410              		.align	1
 411              		.global	i2c1_write_byte_array
 412              		.syntax unified
ARM GAS  /tmp/cch08t2F.s 			page 12


 413              		.thumb
 414              		.thumb_func
 416              	i2c1_write_byte_array:
 417              	.LVL7:
 418              	.LFB72:
 152:Core/Src/hw_i2c1.c **** 
 153:Core/Src/hw_i2c1.c **** void i2c1_write_byte_array(uint8_t *data[], size_t len)
 154:Core/Src/hw_i2c1.c **** {
 419              		.loc 1 154 1 is_stmt 1 view -0
 420              		.cfi_startproc
 421              		@ args = 0, pretend = 0, frame = 0
 422              		@ frame_needed = 0, uses_anonymous_args = 0
 423              		.loc 1 154 1 is_stmt 0 view .LVU104
 424 0000 08B5     		push	{r3, lr}
 425              	.LCFI3:
 426              		.cfi_def_cfa_offset 8
 427              		.cfi_offset 3, -8
 428              		.cfi_offset 14, -4
 429 0002 0A46     		mov	r2, r1
 155:Core/Src/hw_i2c1.c ****   buf_write(&buf_tx, data, len);
 430              		.loc 1 155 3 is_stmt 1 view .LVU105
 431 0004 0146     		mov	r1, r0
 432              	.LVL8:
 433              		.loc 1 155 3 is_stmt 0 view .LVU106
 434 0006 0248     		ldr	r0, .L23
 435              	.LVL9:
 436              		.loc 1 155 3 view .LVU107
 437 0008 FFF7FEFF 		bl	buf_write
 438              	.LVL10:
 156:Core/Src/hw_i2c1.c **** }
 439              		.loc 1 156 1 view .LVU108
 440 000c 08BD     		pop	{r3, pc}
 441              	.L24:
 442 000e 00BF     		.align	2
 443              	.L23:
 444 0010 00000000 		.word	.LANCHOR1
 445              		.cfi_endproc
 446              	.LFE72:
 448              		.section	.text.i2c_poll,"ax",%progbits
 449              		.align	1
 450              		.global	i2c_poll
 451              		.syntax unified
 452              		.thumb
 453              		.thumb_func
 455              	i2c_poll:
 456              	.LFB73:
 157:Core/Src/hw_i2c1.c **** 
 158:Core/Src/hw_i2c1.c **** /* Come back around to execute pending tasks */
 159:Core/Src/hw_i2c1.c **** void i2c_poll(void)
 160:Core/Src/hw_i2c1.c **** {
 457              		.loc 1 160 1 is_stmt 1 view -0
 458              		.cfi_startproc
 459              		@ args = 0, pretend = 0, frame = 0
 460              		@ frame_needed = 0, uses_anonymous_args = 0
 461              		@ link register save eliminated.
 161:Core/Src/hw_i2c1.c ****   /* if sending, send. etc */
 162:Core/Src/hw_i2c1.c **** }...
ARM GAS  /tmp/cch08t2F.s 			page 13


 462              		.loc 1 162 1 view .LVU110
 463 0000 7047     		bx	lr
 464              		.cfi_endproc
 465              	.LFE73:
 467              		.section	.bss.buf_rx,"aw",%nobits
 468              		.align	2
 469              		.set	.LANCHOR3,. + 0
 472              	buf_rx:
 473 0000 00000000 		.space	12
 473      00000000 
 473      00000000 
 474              		.section	.bss.buf_rx_data,"aw",%nobits
 475              		.align	2
 476              		.set	.LANCHOR2,. + 0
 479              	buf_rx_data:
 480 0000 00000000 		.space	255
 480      00000000 
 480      00000000 
 480      00000000 
 480      00000000 
 481              		.section	.bss.buf_tx,"aw",%nobits
 482              		.align	2
 483              		.set	.LANCHOR1,. + 0
 486              	buf_tx:
 487 0000 00000000 		.space	12
 487      00000000 
 487      00000000 
 488              		.section	.bss.buf_tx_data,"aw",%nobits
 489              		.align	2
 490              		.set	.LANCHOR0,. + 0
 493              	buf_tx_data:
 494 0000 00000000 		.space	255
 494      00000000 
 494      00000000 
 494      00000000 
 494      00000000 
 495              		.section	.bss.i2c1_scl,"aw",%nobits
 496              		.align	2
 497              		.set	.LANCHOR4,. + 0
 500              	i2c1_scl:
 501 0000 00000000 		.space	4
 502              		.section	.bss.i2c1_sda,"aw",%nobits
 503              		.align	2
 504              		.set	.LANCHOR5,. + 0
 507              	i2c1_sda:
 508 0000 00000000 		.space	4
 509              		.text
 510              	.Letext0:
 511              		.file 2 "/home/callum/.config/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tools/arm-no
 512              		.file 3 "/home/callum/.config/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tools/arm-no
 513              		.file 4 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/stm32f103xb.h"
 514              		.file 5 "/home/callum/.config/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tools/arm-no
 515              		.file 6 "Core/Inc/hw_stmgpio.h"
 516              		.file 7 "Core/Inc/util_buffer.h"
ARM GAS  /tmp/cch08t2F.s 			page 14


DEFINED SYMBOLS
                            *ABS*:0000000000000000 hw_i2c1.c
     /tmp/cch08t2F.s:18     .text.i2c1_reset:0000000000000000 $t
     /tmp/cch08t2F.s:24     .text.i2c1_reset:0000000000000000 i2c1_reset
     /tmp/cch08t2F.s:48     .text.i2c1_reset:0000000000000014 $d
     /tmp/cch08t2F.s:53     .text.i2c1_init:0000000000000000 $t
     /tmp/cch08t2F.s:59     .text.i2c1_init:0000000000000000 i2c1_init
     /tmp/cch08t2F.s:253    .text.i2c1_init:000000000000010c $d
     /tmp/cch08t2F.s:266    .text.i2c1_enable:0000000000000000 $t
     /tmp/cch08t2F.s:272    .text.i2c1_enable:0000000000000000 i2c1_enable
     /tmp/cch08t2F.s:290    .text.i2c1_enable:000000000000000c $d
     /tmp/cch08t2F.s:295    .text.i2c1_disable:0000000000000000 $t
     /tmp/cch08t2F.s:301    .text.i2c1_disable:0000000000000000 i2c1_disable
     /tmp/cch08t2F.s:319    .text.i2c1_disable:000000000000000c $d
     /tmp/cch08t2F.s:324    .text.i2c1_read_byte:0000000000000000 $t
     /tmp/cch08t2F.s:330    .text.i2c1_read_byte:0000000000000000 i2c1_read_byte
     /tmp/cch08t2F.s:343    .text.i2c1_read_byte_array:0000000000000000 $t
     /tmp/cch08t2F.s:349    .text.i2c1_read_byte_array:0000000000000000 i2c1_read_byte_array
     /tmp/cch08t2F.s:363    .text.i2c1_write_byte:0000000000000000 $t
     /tmp/cch08t2F.s:369    .text.i2c1_write_byte:0000000000000000 i2c1_write_byte
     /tmp/cch08t2F.s:405    .text.i2c1_write_byte:000000000000001c $d
     /tmp/cch08t2F.s:410    .text.i2c1_write_byte_array:0000000000000000 $t
     /tmp/cch08t2F.s:416    .text.i2c1_write_byte_array:0000000000000000 i2c1_write_byte_array
     /tmp/cch08t2F.s:444    .text.i2c1_write_byte_array:0000000000000010 $d
     /tmp/cch08t2F.s:449    .text.i2c_poll:0000000000000000 $t
     /tmp/cch08t2F.s:455    .text.i2c_poll:0000000000000000 i2c_poll
     /tmp/cch08t2F.s:468    .bss.buf_rx:0000000000000000 $d
     /tmp/cch08t2F.s:472    .bss.buf_rx:0000000000000000 buf_rx
     /tmp/cch08t2F.s:475    .bss.buf_rx_data:0000000000000000 $d
     /tmp/cch08t2F.s:479    .bss.buf_rx_data:0000000000000000 buf_rx_data
     /tmp/cch08t2F.s:482    .bss.buf_tx:0000000000000000 $d
     /tmp/cch08t2F.s:486    .bss.buf_tx:0000000000000000 buf_tx
     /tmp/cch08t2F.s:489    .bss.buf_tx_data:0000000000000000 $d
     /tmp/cch08t2F.s:493    .bss.buf_tx_data:0000000000000000 buf_tx_data
     /tmp/cch08t2F.s:496    .bss.i2c1_scl:0000000000000000 $d
     /tmp/cch08t2F.s:500    .bss.i2c1_scl:0000000000000000 i2c1_scl
     /tmp/cch08t2F.s:503    .bss.i2c1_sda:0000000000000000 $d
     /tmp/cch08t2F.s:507    .bss.i2c1_sda:0000000000000000 i2c1_sda

UNDEFINED SYMBOLS
buf_init
stmgpio_setup_gpio
buf_write
