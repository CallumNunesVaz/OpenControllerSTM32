ARM GAS  /tmp/ccx4npfP.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"hw_i2c1.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.i2c1_reset,"ax",%progbits
  18              		.align	1
  19              		.global	i2c1_reset
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	i2c1_reset:
  25              	.LFB66:
  26              		.file 1 "Core/Src/hw_i2c1.c"
   1:Core/Src/hw_i2c1.c **** /* USER CODE BEGIN Header */
   2:Core/Src/hw_i2c1.c **** /**
   3:Core/Src/hw_i2c1.c ****  ******************************************************************************
   4:Core/Src/hw_i2c1.c ****  * @file           : main.c
   5:Core/Src/hw_i2c1.c ****  * @brief          : Main program body
   6:Core/Src/hw_i2c1.c ****  ******************************************************************************
   7:Core/Src/hw_i2c1.c ****  * @attention
   8:Core/Src/hw_i2c1.c ****  *
   9:Core/Src/hw_i2c1.c ****  * <h2><center>&copy; Copyright (c) 2022 STMicroelectronics.
  10:Core/Src/hw_i2c1.c ****  * All rights reserved.</center></h2>
  11:Core/Src/hw_i2c1.c ****  *
  12:Core/Src/hw_i2c1.c ****  * This software component is licensed by ST under BSD 3-Clause license,
  13:Core/Src/hw_i2c1.c ****  * the "License"; You may not use this file except in compliance with the
  14:Core/Src/hw_i2c1.c ****  * License. You may obtain a copy of the License at:
  15:Core/Src/hw_i2c1.c ****  *                        opensource.org/licenses/BSD-3-Clause
  16:Core/Src/hw_i2c1.c ****  *
  17:Core/Src/hw_i2c1.c ****  ******************************************************************************
  18:Core/Src/hw_i2c1.c ****  */
  19:Core/Src/hw_i2c1.c **** /* USER CODE END Header */
  20:Core/Src/hw_i2c1.c **** /* Includes ------------------------------------------------------------------*/
  21:Core/Src/hw_i2c1.c **** #include "hw_i2c1.h"
  22:Core/Src/hw_i2c1.c **** 
  23:Core/Src/hw_i2c1.c **** // https://controllerstech.com/stm32-i2c-configuration-using-registers/
  24:Core/Src/hw_i2c1.c **** 
  25:Core/Src/hw_i2c1.c **** /* GPIO handlers */
  26:Core/Src/hw_i2c1.c **** static stmgpio_t *i2c1_scl;
  27:Core/Src/hw_i2c1.c **** static stmgpio_t *i2c1_sda;
  28:Core/Src/hw_i2c1.c **** 
  29:Core/Src/hw_i2c1.c **** int i2c1_init(void)
  30:Core/Src/hw_i2c1.c **** {
  31:Core/Src/hw_i2c1.c ****   /* We only need these during init */
  32:Core/Src/hw_i2c1.c ****   stmgpio_setup_t i2c1_scl_setup;
ARM GAS  /tmp/ccx4npfP.s 			page 2


  33:Core/Src/hw_i2c1.c ****   stmgpio_setup_t i2c1_sda_setup;
  34:Core/Src/hw_i2c1.c **** 
  35:Core/Src/hw_i2c1.c ****   /* Enable the I2C1 clock */
  36:Core/Src/hw_i2c1.c ****   RCC->APB1ENR |= RCC_APB1ENR_I2C1EN;
  37:Core/Src/hw_i2c1.c **** 
  38:Core/Src/hw_i2c1.c ****   /* USING PB8 and PB9, so enable port B clock if not already */
  39:Core/Src/hw_i2c1.c ****   RCC->APB2ENR |= RCC_APB2ENR_IOPBEN;
  40:Core/Src/hw_i2c1.c **** 
  41:Core/Src/hw_i2c1.c ****   /* Setup the GPIO pins */
  42:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.port = I2C_SCL_PORT;
  43:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pin = I2C_SCL_PIN;
  44:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.cfg = OUT_ALT_OPENDRAIN;
  45:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.dir = OUTPUT_10MHZ;
  46:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pull = PULLUP;
  47:Core/Src/hw_i2c1.c ****   i2c1_scl = stmgpio_setup_gpio(&i2c1_scl_setup);
  48:Core/Src/hw_i2c1.c **** 
  49:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.port = I2C_SDA_PORT;
  50:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pin = I2C_SDA_PIN;
  51:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.cfg = OUT_ALT_OPENDRAIN;
  52:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.dir = OUTPUT_10MHZ;
  53:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pull = PULLUP;
  54:Core/Src/hw_i2c1.c ****   i2c1_sda = stmgpio_setup_gpio(&i2c1_sda_setup);
  55:Core/Src/hw_i2c1.c **** 
  56:Core/Src/hw_i2c1.c ****   /* Set the pin remap for i2c1 */
  57:Core/Src/hw_i2c1.c ****   AFIO->MAPR |= AFIO_MAPR_I2C1_REMAP;
  58:Core/Src/hw_i2c1.c **** 
  59:Core/Src/hw_i2c1.c ****   /* Disable i2c1 peripheral to apply settings */
  60:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_PE;
  61:Core/Src/hw_i2c1.c **** 
  62:Core/Src/hw_i2c1.c ****   /* Disable clock stretching */
  63:Core/Src/hw_i2c1.c ****   I2C1->CR1 |= I2C_CR1_NOSTRETCH;
  64:Core/Src/hw_i2c1.c **** 
  65:Core/Src/hw_i2c1.c ****   /* Disable general call */
  66:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_ENGC;
  67:Core/Src/hw_i2c1.c **** 
  68:Core/Src/hw_i2c1.c ****   /* Disable SMBUS. Using I2C */
  69:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_SMBUS;
  70:Core/Src/hw_i2c1.c **** 
  71:Core/Src/hw_i2c1.c ****   /* Disable DMA */
  72:Core/Src/hw_i2c1.c ****   I2C1->CR2 &= ~I2C_CR2_DMAEN;
  73:Core/Src/hw_i2c1.c **** 
  74:Core/Src/hw_i2c1.c ****   /* Enable DMA TX buffer interrupt */
  75:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= I2C_CR2_ITBUFEN;
  76:Core/Src/hw_i2c1.c **** 
  77:Core/Src/hw_i2c1.c ****   /* Enable event interrupt */
  78:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= I2C_CR2_ITEVTEN;
  79:Core/Src/hw_i2c1.c **** 
  80:Core/Src/hw_i2c1.c ****   /* Enable error interrupt */
  81:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= I2C_CR2_ITERREN;
  82:Core/Src/hw_i2c1.c **** 
  83:Core/Src/hw_i2c1.c ****   /* Inform of APB bus frequency */
  84:Core/Src/hw_i2c1.c ****   I2C1->CR2 &= ~I2C_CR2_FREQ;
  85:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= APB_BUS_FREQ_MHZ;
  86:Core/Src/hw_i2c1.c **** 
  87:Core/Src/hw_i2c1.c ****   /* Set to standard mode */
  88:Core/Src/hw_i2c1.c ****   I2C1->CCR &= ~I2C_CCR_FS;
  89:Core/Src/hw_i2c1.c **** 
ARM GAS  /tmp/ccx4npfP.s 			page 3


  90:Core/Src/hw_i2c1.c ****   /* Set clock for 100kHz */
  91:Core/Src/hw_i2c1.c ****   I2C1->CCR &= ~I2C_CCR_CCR;
  92:Core/Src/hw_i2c1.c ****   I2C1->CCR |= 250;
  93:Core/Src/hw_i2c1.c **** 
  94:Core/Src/hw_i2c1.c ****   /* Set rise time for 1000ns */
  95:Core/Src/hw_i2c1.c ****   I2C1->TRISE &= ~I2C_TRISE_TRISE;
  96:Core/Src/hw_i2c1.c ****   I2C1->TRISE |= 50;
  97:Core/Src/hw_i2c1.c **** 
  98:Core/Src/hw_i2c1.c ****   /* Enable i2c1 peripheral */
  99:Core/Src/hw_i2c1.c ****   I2C1->CR1 |= I2C_CR1_PE;
 100:Core/Src/hw_i2c1.c **** 
 101:Core/Src/hw_i2c1.c ****   /* Trigger reset before first usage */
 102:Core/Src/hw_i2c1.c ****   i2c1_reset();
 103:Core/Src/hw_i2c1.c **** 
 104:Core/Src/hw_i2c1.c ****   return EXIT_SUCCESS;
 105:Core/Src/hw_i2c1.c **** }
 106:Core/Src/hw_i2c1.c **** 
 107:Core/Src/hw_i2c1.c **** void i2c1_reset(void)
 108:Core/Src/hw_i2c1.c **** {
  27              		.loc 1 108 1 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
 109:Core/Src/hw_i2c1.c ****   I2C1->CR1 |= I2C_CR1_SWRST;
  32              		.loc 1 109 3 view .LVU1
  33              		.loc 1 109 13 is_stmt 0 view .LVU2
  34 0000 044B     		ldr	r3, .L2
  35 0002 1A68     		ldr	r2, [r3]
  36 0004 42F40042 		orr	r2, r2, #32768
  37 0008 1A60     		str	r2, [r3]
 110:Core/Src/hw_i2c1.c ****   // make sure the I2C lines are released and the bus is free
 111:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_SWRST;
  38              		.loc 1 111 3 is_stmt 1 view .LVU3
  39              		.loc 1 111 13 is_stmt 0 view .LVU4
  40 000a 1A68     		ldr	r2, [r3]
  41 000c 22F40042 		bic	r2, r2, #32768
  42 0010 1A60     		str	r2, [r3]
 112:Core/Src/hw_i2c1.c **** }
  43              		.loc 1 112 1 view .LVU5
  44 0012 7047     		bx	lr
  45              	.L3:
  46              		.align	2
  47              	.L2:
  48 0014 00540040 		.word	1073763328
  49              		.cfi_endproc
  50              	.LFE66:
  52              		.section	.text.i2c1_init,"ax",%progbits
  53              		.align	1
  54              		.global	i2c1_init
  55              		.syntax unified
  56              		.thumb
  57              		.thumb_func
  59              	i2c1_init:
  60              	.LFB65:
  30:Core/Src/hw_i2c1.c ****   /* We only need these during init */
  61              		.loc 1 30 1 is_stmt 1 view -0
ARM GAS  /tmp/ccx4npfP.s 			page 4


  62              		.cfi_startproc
  63              		@ args = 0, pretend = 0, frame = 16
  64              		@ frame_needed = 0, uses_anonymous_args = 0
  65 0000 70B5     		push	{r4, r5, r6, lr}
  66              	.LCFI0:
  67              		.cfi_def_cfa_offset 16
  68              		.cfi_offset 4, -16
  69              		.cfi_offset 5, -12
  70              		.cfi_offset 6, -8
  71              		.cfi_offset 14, -4
  72 0002 84B0     		sub	sp, sp, #16
  73              	.LCFI1:
  74              		.cfi_def_cfa_offset 32
  32:Core/Src/hw_i2c1.c ****   stmgpio_setup_t i2c1_sda_setup;
  75              		.loc 1 32 3 view .LVU7
  33:Core/Src/hw_i2c1.c **** 
  76              		.loc 1 33 3 view .LVU8
  36:Core/Src/hw_i2c1.c **** 
  77              		.loc 1 36 3 view .LVU9
  36:Core/Src/hw_i2c1.c **** 
  78              		.loc 1 36 16 is_stmt 0 view .LVU10
  79 0004 3C4B     		ldr	r3, .L6
  80 0006 DA69     		ldr	r2, [r3, #28]
  81 0008 42F40012 		orr	r2, r2, #2097152
  82 000c DA61     		str	r2, [r3, #28]
  39:Core/Src/hw_i2c1.c **** 
  83              		.loc 1 39 3 is_stmt 1 view .LVU11
  39:Core/Src/hw_i2c1.c **** 
  84              		.loc 1 39 16 is_stmt 0 view .LVU12
  85 000e 9A69     		ldr	r2, [r3, #24]
  86 0010 42F00802 		orr	r2, r2, #8
  87 0014 9A61     		str	r2, [r3, #24]
  42:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pin = I2C_SCL_PIN;
  88              		.loc 1 42 3 is_stmt 1 view .LVU13
  42:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pin = I2C_SCL_PIN;
  89              		.loc 1 42 23 is_stmt 0 view .LVU14
  90 0016 4226     		movs	r6, #66
  91 0018 8DF80B60 		strb	r6, [sp, #11]
  43:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.cfg = OUT_ALT_OPENDRAIN;
  92              		.loc 1 43 3 is_stmt 1 view .LVU15
  43:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.cfg = OUT_ALT_OPENDRAIN;
  93              		.loc 1 43 22 is_stmt 0 view .LVU16
  94 001c 0823     		movs	r3, #8
  95 001e 8DF80C30 		strb	r3, [sp, #12]
  44:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.dir = OUTPUT_10MHZ;
  96              		.loc 1 44 3 is_stmt 1 view .LVU17
  44:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.dir = OUTPUT_10MHZ;
  97              		.loc 1 44 22 is_stmt 0 view .LVU18
  98 0022 0725     		movs	r5, #7
  99 0024 8DF80950 		strb	r5, [sp, #9]
  45:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pull = PULLUP;
 100              		.loc 1 45 3 is_stmt 1 view .LVU19
  45:Core/Src/hw_i2c1.c ****   i2c1_scl_setup.pull = PULLUP;
 101              		.loc 1 45 22 is_stmt 0 view .LVU20
 102 0028 0124     		movs	r4, #1
 103 002a 8DF80840 		strb	r4, [sp, #8]
  46:Core/Src/hw_i2c1.c ****   i2c1_scl = stmgpio_setup_gpio(&i2c1_scl_setup);
ARM GAS  /tmp/ccx4npfP.s 			page 5


 104              		.loc 1 46 3 is_stmt 1 view .LVU21
  46:Core/Src/hw_i2c1.c ****   i2c1_scl = stmgpio_setup_gpio(&i2c1_scl_setup);
 105              		.loc 1 46 23 is_stmt 0 view .LVU22
 106 002e 8DF80A40 		strb	r4, [sp, #10]
  47:Core/Src/hw_i2c1.c **** 
 107              		.loc 1 47 3 is_stmt 1 view .LVU23
  47:Core/Src/hw_i2c1.c **** 
 108              		.loc 1 47 14 is_stmt 0 view .LVU24
 109 0032 0DEB0300 		add	r0, sp, r3
 110 0036 FFF7FEFF 		bl	stmgpio_setup_gpio
 111              	.LVL0:
  47:Core/Src/hw_i2c1.c **** 
 112              		.loc 1 47 12 view .LVU25
 113 003a 304B     		ldr	r3, .L6+4
 114 003c 1860     		str	r0, [r3]
  49:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pin = I2C_SDA_PIN;
 115              		.loc 1 49 3 is_stmt 1 view .LVU26
  49:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pin = I2C_SDA_PIN;
 116              		.loc 1 49 23 is_stmt 0 view .LVU27
 117 003e 8DF80360 		strb	r6, [sp, #3]
  50:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.cfg = OUT_ALT_OPENDRAIN;
 118              		.loc 1 50 3 is_stmt 1 view .LVU28
  50:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.cfg = OUT_ALT_OPENDRAIN;
 119              		.loc 1 50 22 is_stmt 0 view .LVU29
 120 0042 0923     		movs	r3, #9
 121 0044 8DF80430 		strb	r3, [sp, #4]
  51:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.dir = OUTPUT_10MHZ;
 122              		.loc 1 51 3 is_stmt 1 view .LVU30
  51:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.dir = OUTPUT_10MHZ;
 123              		.loc 1 51 22 is_stmt 0 view .LVU31
 124 0048 8DF80150 		strb	r5, [sp, #1]
  52:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pull = PULLUP;
 125              		.loc 1 52 3 is_stmt 1 view .LVU32
  52:Core/Src/hw_i2c1.c ****   i2c1_sda_setup.pull = PULLUP;
 126              		.loc 1 52 22 is_stmt 0 view .LVU33
 127 004c 8DF80040 		strb	r4, [sp]
  53:Core/Src/hw_i2c1.c ****   i2c1_sda = stmgpio_setup_gpio(&i2c1_sda_setup);
 128              		.loc 1 53 3 is_stmt 1 view .LVU34
  53:Core/Src/hw_i2c1.c ****   i2c1_sda = stmgpio_setup_gpio(&i2c1_sda_setup);
 129              		.loc 1 53 23 is_stmt 0 view .LVU35
 130 0050 8DF80240 		strb	r4, [sp, #2]
  54:Core/Src/hw_i2c1.c **** 
 131              		.loc 1 54 3 is_stmt 1 view .LVU36
  54:Core/Src/hw_i2c1.c **** 
 132              		.loc 1 54 14 is_stmt 0 view .LVU37
 133 0054 6846     		mov	r0, sp
 134 0056 FFF7FEFF 		bl	stmgpio_setup_gpio
 135              	.LVL1:
  54:Core/Src/hw_i2c1.c **** 
 136              		.loc 1 54 12 view .LVU38
 137 005a 294B     		ldr	r3, .L6+8
 138 005c 1860     		str	r0, [r3]
  57:Core/Src/hw_i2c1.c **** 
 139              		.loc 1 57 3 is_stmt 1 view .LVU39
  57:Core/Src/hw_i2c1.c **** 
 140              		.loc 1 57 14 is_stmt 0 view .LVU40
 141 005e 294A     		ldr	r2, .L6+12
ARM GAS  /tmp/ccx4npfP.s 			page 6


 142 0060 5368     		ldr	r3, [r2, #4]
 143 0062 43F00203 		orr	r3, r3, #2
 144 0066 5360     		str	r3, [r2, #4]
  60:Core/Src/hw_i2c1.c **** 
 145              		.loc 1 60 3 is_stmt 1 view .LVU41
  60:Core/Src/hw_i2c1.c **** 
 146              		.loc 1 60 13 is_stmt 0 view .LVU42
 147 0068 274B     		ldr	r3, .L6+16
 148 006a 1A68     		ldr	r2, [r3]
 149 006c 22F00102 		bic	r2, r2, #1
 150 0070 1A60     		str	r2, [r3]
  63:Core/Src/hw_i2c1.c **** 
 151              		.loc 1 63 3 is_stmt 1 view .LVU43
  63:Core/Src/hw_i2c1.c **** 
 152              		.loc 1 63 13 is_stmt 0 view .LVU44
 153 0072 1A68     		ldr	r2, [r3]
 154 0074 42F08002 		orr	r2, r2, #128
 155 0078 1A60     		str	r2, [r3]
  66:Core/Src/hw_i2c1.c **** 
 156              		.loc 1 66 3 is_stmt 1 view .LVU45
  66:Core/Src/hw_i2c1.c **** 
 157              		.loc 1 66 13 is_stmt 0 view .LVU46
 158 007a 1A68     		ldr	r2, [r3]
 159 007c 22F04002 		bic	r2, r2, #64
 160 0080 1A60     		str	r2, [r3]
  69:Core/Src/hw_i2c1.c **** 
 161              		.loc 1 69 3 is_stmt 1 view .LVU47
  69:Core/Src/hw_i2c1.c **** 
 162              		.loc 1 69 13 is_stmt 0 view .LVU48
 163 0082 1A68     		ldr	r2, [r3]
 164 0084 22F00202 		bic	r2, r2, #2
 165 0088 1A60     		str	r2, [r3]
  72:Core/Src/hw_i2c1.c **** 
 166              		.loc 1 72 3 is_stmt 1 view .LVU49
  72:Core/Src/hw_i2c1.c **** 
 167              		.loc 1 72 13 is_stmt 0 view .LVU50
 168 008a 5A68     		ldr	r2, [r3, #4]
 169 008c 22F40062 		bic	r2, r2, #2048
 170 0090 5A60     		str	r2, [r3, #4]
  75:Core/Src/hw_i2c1.c **** 
 171              		.loc 1 75 3 is_stmt 1 view .LVU51
  75:Core/Src/hw_i2c1.c **** 
 172              		.loc 1 75 13 is_stmt 0 view .LVU52
 173 0092 5A68     		ldr	r2, [r3, #4]
 174 0094 42F48062 		orr	r2, r2, #1024
 175 0098 5A60     		str	r2, [r3, #4]
  78:Core/Src/hw_i2c1.c **** 
 176              		.loc 1 78 3 is_stmt 1 view .LVU53
  78:Core/Src/hw_i2c1.c **** 
 177              		.loc 1 78 13 is_stmt 0 view .LVU54
 178 009a 5A68     		ldr	r2, [r3, #4]
 179 009c 42F40072 		orr	r2, r2, #512
 180 00a0 5A60     		str	r2, [r3, #4]
  81:Core/Src/hw_i2c1.c **** 
 181              		.loc 1 81 3 is_stmt 1 view .LVU55
  81:Core/Src/hw_i2c1.c **** 
 182              		.loc 1 81 13 is_stmt 0 view .LVU56
ARM GAS  /tmp/ccx4npfP.s 			page 7


 183 00a2 5A68     		ldr	r2, [r3, #4]
 184 00a4 42F48072 		orr	r2, r2, #256
 185 00a8 5A60     		str	r2, [r3, #4]
  84:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= APB_BUS_FREQ_MHZ;
 186              		.loc 1 84 3 is_stmt 1 view .LVU57
  84:Core/Src/hw_i2c1.c ****   I2C1->CR2 |= APB_BUS_FREQ_MHZ;
 187              		.loc 1 84 13 is_stmt 0 view .LVU58
 188 00aa 5A68     		ldr	r2, [r3, #4]
 189 00ac 22F03F02 		bic	r2, r2, #63
 190 00b0 5A60     		str	r2, [r3, #4]
  85:Core/Src/hw_i2c1.c **** 
 191              		.loc 1 85 3 is_stmt 1 view .LVU59
  85:Core/Src/hw_i2c1.c **** 
 192              		.loc 1 85 13 is_stmt 0 view .LVU60
 193 00b2 5A68     		ldr	r2, [r3, #4]
 194 00b4 42F03202 		orr	r2, r2, #50
 195 00b8 5A60     		str	r2, [r3, #4]
  88:Core/Src/hw_i2c1.c **** 
 196              		.loc 1 88 3 is_stmt 1 view .LVU61
  88:Core/Src/hw_i2c1.c **** 
 197              		.loc 1 88 13 is_stmt 0 view .LVU62
 198 00ba DA69     		ldr	r2, [r3, #28]
 199 00bc 22F40042 		bic	r2, r2, #32768
 200 00c0 DA61     		str	r2, [r3, #28]
  91:Core/Src/hw_i2c1.c ****   I2C1->CCR |= 250;
 201              		.loc 1 91 3 is_stmt 1 view .LVU63
  91:Core/Src/hw_i2c1.c ****   I2C1->CCR |= 250;
 202              		.loc 1 91 13 is_stmt 0 view .LVU64
 203 00c2 DA69     		ldr	r2, [r3, #28]
 204 00c4 22F47F62 		bic	r2, r2, #4080
 205 00c8 22F00F02 		bic	r2, r2, #15
 206 00cc DA61     		str	r2, [r3, #28]
  92:Core/Src/hw_i2c1.c **** 
 207              		.loc 1 92 3 is_stmt 1 view .LVU65
  92:Core/Src/hw_i2c1.c **** 
 208              		.loc 1 92 13 is_stmt 0 view .LVU66
 209 00ce DA69     		ldr	r2, [r3, #28]
 210 00d0 42F0FA02 		orr	r2, r2, #250
 211 00d4 DA61     		str	r2, [r3, #28]
  95:Core/Src/hw_i2c1.c ****   I2C1->TRISE |= 50;
 212              		.loc 1 95 3 is_stmt 1 view .LVU67
  95:Core/Src/hw_i2c1.c ****   I2C1->TRISE |= 50;
 213              		.loc 1 95 15 is_stmt 0 view .LVU68
 214 00d6 1A6A     		ldr	r2, [r3, #32]
 215 00d8 22F03F02 		bic	r2, r2, #63
 216 00dc 1A62     		str	r2, [r3, #32]
  96:Core/Src/hw_i2c1.c **** 
 217              		.loc 1 96 3 is_stmt 1 view .LVU69
  96:Core/Src/hw_i2c1.c **** 
 218              		.loc 1 96 15 is_stmt 0 view .LVU70
 219 00de 1A6A     		ldr	r2, [r3, #32]
 220 00e0 42F03202 		orr	r2, r2, #50
 221 00e4 1A62     		str	r2, [r3, #32]
  99:Core/Src/hw_i2c1.c **** 
 222              		.loc 1 99 3 is_stmt 1 view .LVU71
  99:Core/Src/hw_i2c1.c **** 
 223              		.loc 1 99 13 is_stmt 0 view .LVU72
ARM GAS  /tmp/ccx4npfP.s 			page 8


 224 00e6 1A68     		ldr	r2, [r3]
 225 00e8 2243     		orrs	r2, r2, r4
 226 00ea 1A60     		str	r2, [r3]
 102:Core/Src/hw_i2c1.c **** 
 227              		.loc 1 102 3 is_stmt 1 view .LVU73
 228 00ec FFF7FEFF 		bl	i2c1_reset
 229              	.LVL2:
 104:Core/Src/hw_i2c1.c **** }
 230              		.loc 1 104 3 view .LVU74
 105:Core/Src/hw_i2c1.c **** 
 231              		.loc 1 105 1 is_stmt 0 view .LVU75
 232 00f0 0020     		movs	r0, #0
 233 00f2 04B0     		add	sp, sp, #16
 234              	.LCFI2:
 235              		.cfi_def_cfa_offset 16
 236              		@ sp needed
 237 00f4 70BD     		pop	{r4, r5, r6, pc}
 238              	.L7:
 239 00f6 00BF     		.align	2
 240              	.L6:
 241 00f8 00100240 		.word	1073876992
 242 00fc 00000000 		.word	.LANCHOR0
 243 0100 00000000 		.word	.LANCHOR1
 244 0104 00000140 		.word	1073807360
 245 0108 00540040 		.word	1073763328
 246              		.cfi_endproc
 247              	.LFE65:
 249              		.section	.text.i2c1_enable,"ax",%progbits
 250              		.align	1
 251              		.global	i2c1_enable
 252              		.syntax unified
 253              		.thumb
 254              		.thumb_func
 256              	i2c1_enable:
 257              	.LFB67:
 113:Core/Src/hw_i2c1.c **** 
 114:Core/Src/hw_i2c1.c **** void i2c1_enable(void)
 115:Core/Src/hw_i2c1.c **** {
 258              		.loc 1 115 1 is_stmt 1 view -0
 259              		.cfi_startproc
 260              		@ args = 0, pretend = 0, frame = 0
 261              		@ frame_needed = 0, uses_anonymous_args = 0
 262              		@ link register save eliminated.
 116:Core/Src/hw_i2c1.c ****   I2C1->CR1 |= I2C_CR1_PE;
 263              		.loc 1 116 3 view .LVU77
 264              		.loc 1 116 13 is_stmt 0 view .LVU78
 265 0000 024A     		ldr	r2, .L9
 266 0002 1368     		ldr	r3, [r2]
 267 0004 43F00103 		orr	r3, r3, #1
 268 0008 1360     		str	r3, [r2]
 117:Core/Src/hw_i2c1.c **** }
 269              		.loc 1 117 1 view .LVU79
 270 000a 7047     		bx	lr
 271              	.L10:
 272              		.align	2
 273              	.L9:
 274 000c 00540040 		.word	1073763328
ARM GAS  /tmp/ccx4npfP.s 			page 9


 275              		.cfi_endproc
 276              	.LFE67:
 278              		.section	.text.i2c1_disable,"ax",%progbits
 279              		.align	1
 280              		.global	i2c1_disable
 281              		.syntax unified
 282              		.thumb
 283              		.thumb_func
 285              	i2c1_disable:
 286              	.LFB68:
 118:Core/Src/hw_i2c1.c **** 
 119:Core/Src/hw_i2c1.c **** void i2c1_disable(void)
 120:Core/Src/hw_i2c1.c **** {
 287              		.loc 1 120 1 is_stmt 1 view -0
 288              		.cfi_startproc
 289              		@ args = 0, pretend = 0, frame = 0
 290              		@ frame_needed = 0, uses_anonymous_args = 0
 291              		@ link register save eliminated.
 121:Core/Src/hw_i2c1.c ****   I2C1->CR1 &= ~I2C_CR1_PE;
 292              		.loc 1 121 3 view .LVU81
 293              		.loc 1 121 13 is_stmt 0 view .LVU82
 294 0000 024A     		ldr	r2, .L12
 295 0002 1368     		ldr	r3, [r2]
 296 0004 23F00103 		bic	r3, r3, #1
 297 0008 1360     		str	r3, [r2]
 122:Core/Src/hw_i2c1.c **** }
 298              		.loc 1 122 1 view .LVU83
 299 000a 7047     		bx	lr
 300              	.L13:
 301              		.align	2
 302              	.L12:
 303 000c 00540040 		.word	1073763328
 304              		.cfi_endproc
 305              	.LFE68:
 307              		.section	.text.i2c1_read,"ax",%progbits
 308              		.align	1
 309              		.global	i2c1_read
 310              		.syntax unified
 311              		.thumb
 312              		.thumb_func
 314              	i2c1_read:
 315              	.LFB69:
 123:Core/Src/hw_i2c1.c **** 
 124:Core/Src/hw_i2c1.c **** uint8_t i2c1_read(void)
 125:Core/Src/hw_i2c1.c **** {
 316              		.loc 1 125 1 is_stmt 1 view -0
 317              		.cfi_startproc
 318              		@ args = 0, pretend = 0, frame = 0
 319              		@ frame_needed = 0, uses_anonymous_args = 0
 320              		@ link register save eliminated.
 126:Core/Src/hw_i2c1.c **** 
 127:Core/Src/hw_i2c1.c **** }
 321              		.loc 1 127 1 view .LVU85
 322 0000 7047     		bx	lr
 323              		.cfi_endproc
 324              	.LFE69:
 326              		.section	.text.i2c1_write,"ax",%progbits
ARM GAS  /tmp/ccx4npfP.s 			page 10


 327              		.align	1
 328              		.global	i2c1_write
 329              		.syntax unified
 330              		.thumb
 331              		.thumb_func
 333              	i2c1_write:
 334              	.LFB70:
 128:Core/Src/hw_i2c1.c **** 
 129:Core/Src/hw_i2c1.c **** void i2c1_write(uint8_t data)
 130:Core/Src/hw_i2c1.c **** {
 335              		.loc 1 130 1 view -0
 336              		.cfi_startproc
 337              		@ args = 0, pretend = 0, frame = 0
 338              		@ frame_needed = 0, uses_anonymous_args = 0
 339              		@ link register save eliminated.
 340              	.LVL3:
 341              	.L16:
 131:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 7)))
 132:Core/Src/hw_i2c1.c ****     ; // wait for TXE bit to set
 342              		.loc 1 132 5 discriminator 1 view .LVU87
 131:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 7)))
 343              		.loc 1 131 9 discriminator 1 view .LVU88
 131:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 7)))
 344              		.loc 1 131 16 is_stmt 0 discriminator 1 view .LVU89
 345 0000 064B     		ldr	r3, .L18
 346 0002 5B69     		ldr	r3, [r3, #20]
 131:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 7)))
 347              		.loc 1 131 9 discriminator 1 view .LVU90
 348 0004 13F0800F 		tst	r3, #128
 349 0008 FAD0     		beq	.L16
 133:Core/Src/hw_i2c1.c **** 
 134:Core/Src/hw_i2c1.c ****   /* Set register bit */
 135:Core/Src/hw_i2c1.c ****   I2C1->DR = data;
 350              		.loc 1 135 3 is_stmt 1 view .LVU91
 351              		.loc 1 135 12 is_stmt 0 view .LVU92
 352 000a 044B     		ldr	r3, .L18
 353 000c 1861     		str	r0, [r3, #16]
 136:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 2)))
 354              		.loc 1 136 3 is_stmt 1 view .LVU93
 355              	.L17:
 137:Core/Src/hw_i2c1.c ****     ; // wait for BTF bit to set
 356              		.loc 1 137 5 discriminator 1 view .LVU94
 136:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 2)))
 357              		.loc 1 136 9 discriminator 1 view .LVU95
 136:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 2)))
 358              		.loc 1 136 16 is_stmt 0 discriminator 1 view .LVU96
 359 000e 034B     		ldr	r3, .L18
 360 0010 5B69     		ldr	r3, [r3, #20]
 136:Core/Src/hw_i2c1.c ****   while (!(I2C1->SR1 & (1 << 2)))
 361              		.loc 1 136 9 discriminator 1 view .LVU97
 362 0012 13F0040F 		tst	r3, #4
 363 0016 FAD0     		beq	.L17
 138:Core/Src/hw_i2c1.c **** }...
 364              		.loc 1 138 1 view .LVU98
 365 0018 7047     		bx	lr
 366              	.L19:
 367 001a 00BF     		.align	2
ARM GAS  /tmp/ccx4npfP.s 			page 11


 368              	.L18:
 369 001c 00540040 		.word	1073763328
 370              		.cfi_endproc
 371              	.LFE70:
 373              		.section	.bss.i2c1_scl,"aw",%nobits
 374              		.align	2
 375              		.set	.LANCHOR0,. + 0
 378              	i2c1_scl:
 379 0000 00000000 		.space	4
 380              		.section	.bss.i2c1_sda,"aw",%nobits
 381              		.align	2
 382              		.set	.LANCHOR1,. + 0
 385              	i2c1_sda:
 386 0000 00000000 		.space	4
 387              		.text
 388              	.Letext0:
 389              		.file 2 "/home/callum/.config/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tools/arm-no
 390              		.file 3 "/home/callum/.config/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tools/arm-no
 391              		.file 4 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/stm32f103xb.h"
 392              		.file 5 "Core/Inc/hw_stmgpio.h"
ARM GAS  /tmp/ccx4npfP.s 			page 12


DEFINED SYMBOLS
                            *ABS*:0000000000000000 hw_i2c1.c
     /tmp/ccx4npfP.s:18     .text.i2c1_reset:0000000000000000 $t
     /tmp/ccx4npfP.s:24     .text.i2c1_reset:0000000000000000 i2c1_reset
     /tmp/ccx4npfP.s:48     .text.i2c1_reset:0000000000000014 $d
     /tmp/ccx4npfP.s:53     .text.i2c1_init:0000000000000000 $t
     /tmp/ccx4npfP.s:59     .text.i2c1_init:0000000000000000 i2c1_init
     /tmp/ccx4npfP.s:241    .text.i2c1_init:00000000000000f8 $d
     /tmp/ccx4npfP.s:250    .text.i2c1_enable:0000000000000000 $t
     /tmp/ccx4npfP.s:256    .text.i2c1_enable:0000000000000000 i2c1_enable
     /tmp/ccx4npfP.s:274    .text.i2c1_enable:000000000000000c $d
     /tmp/ccx4npfP.s:279    .text.i2c1_disable:0000000000000000 $t
     /tmp/ccx4npfP.s:285    .text.i2c1_disable:0000000000000000 i2c1_disable
     /tmp/ccx4npfP.s:303    .text.i2c1_disable:000000000000000c $d
     /tmp/ccx4npfP.s:308    .text.i2c1_read:0000000000000000 $t
     /tmp/ccx4npfP.s:314    .text.i2c1_read:0000000000000000 i2c1_read
     /tmp/ccx4npfP.s:327    .text.i2c1_write:0000000000000000 $t
     /tmp/ccx4npfP.s:333    .text.i2c1_write:0000000000000000 i2c1_write
     /tmp/ccx4npfP.s:369    .text.i2c1_write:000000000000001c $d
     /tmp/ccx4npfP.s:374    .bss.i2c1_scl:0000000000000000 $d
     /tmp/ccx4npfP.s:378    .bss.i2c1_scl:0000000000000000 i2c1_scl
     /tmp/ccx4npfP.s:381    .bss.i2c1_sda:0000000000000000 $d
     /tmp/ccx4npfP.s:385    .bss.i2c1_sda:0000000000000000 i2c1_sda

UNDEFINED SYMBOLS
stmgpio_setup_gpio
