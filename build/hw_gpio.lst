ARM GAS  /tmp/ccr9mM5i.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"hw_gpio.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.hw_gpio_setup_gpio,"ax",%progbits
  18              		.align	1
  19              		.global	hw_gpio_setup_gpio
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	hw_gpio_setup_gpio:
  25              	.LVL0:
  26              	.LFB65:
  27              		.file 1 "Core/Src/hw_gpio.c"
   1:Core/Src/hw_gpio.c **** /*
   2:Core/Src/hw_gpio.c **** GPIO library designed to be relatively lightwieght but human readable.
   3:Core/Src/hw_gpio.c **** Very much not memory-safe! libraries using this library must manage assigned GPIO.
   4:Core/Src/hw_gpio.c **** */
   5:Core/Src/hw_gpio.c **** #include "hw_gpio.h"
   6:Core/Src/hw_gpio.c **** 
   7:Core/Src/hw_gpio.c **** gpio_t *hw_gpio_setup_gpio(gpio_setup_t* gs)
   8:Core/Src/hw_gpio.c **** {
  28              		.loc 1 8 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		.loc 1 8 1 is_stmt 0 view .LVU1
  33 0000 38B5     		push	{r3, r4, r5, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 16
  36              		.cfi_offset 3, -16
  37              		.cfi_offset 4, -12
  38              		.cfi_offset 5, -8
  39              		.cfi_offset 14, -4
   9:Core/Src/hw_gpio.c ****   /* Allocate variable */
  10:Core/Src/hw_gpio.c ****   gpio_t *g = NULL;
  40              		.loc 1 10 3 is_stmt 1 view .LVU2
  41              	.LVL1:
  11:Core/Src/hw_gpio.c **** 
  12:Core/Src/hw_gpio.c ****   /* Sanity checks */
  13:Core/Src/hw_gpio.c ****   if (('A' <= gs->port) && (gs->port <= 'E') && (gs->dir < DIR_CNT) && (gs->cfg < TYPE_CNT) && (gs-
  42              		.loc 1 13 3 view .LVU3
  43              		.loc 1 13 17 is_stmt 0 view .LVU4
  44 0002 8578     		ldrb	r5, [r0, #2]	@ zero_extendqisi2
  45              		.loc 1 13 25 view .LVU5
ARM GAS  /tmp/ccr9mM5i.s 			page 2


  46 0004 A5F14103 		sub	r3, r5, #65
  47 0008 DBB2     		uxtb	r3, r3
  48              		.loc 1 13 6 view .LVU6
  49 000a 042B     		cmp	r3, #4
  50 000c 00F28A80 		bhi	.L11
  51 0010 0446     		mov	r4, r0
  52              		.loc 1 13 52 discriminator 1 view .LVU7
  53 0012 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
  54              		.loc 1 13 46 discriminator 1 view .LVU8
  55 0014 032B     		cmp	r3, #3
  56 0016 00F28780 		bhi	.L12
  57              		.loc 1 13 75 discriminator 2 view .LVU9
  58 001a 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
  59              		.loc 1 13 69 discriminator 2 view .LVU10
  60 001c 072B     		cmp	r3, #7
  61 001e 00F28580 		bhi	.L13
  62              		.loc 1 13 99 discriminator 3 view .LVU11
  63 0022 C378     		ldrb	r3, [r0, #3]	@ zero_extendqisi2
  64              		.loc 1 13 93 discriminator 3 view .LVU12
  65 0024 0F2B     		cmp	r3, #15
  66 0026 00F28380 		bhi	.L14
  14:Core/Src/hw_gpio.c ****   {
  15:Core/Src/hw_gpio.c ****     /* Allocate memory */
  16:Core/Src/hw_gpio.c ****     g = malloc(sizeof(gpio_t));
  67              		.loc 1 16 5 is_stmt 1 view .LVU13
  68              		.loc 1 16 9 is_stmt 0 view .LVU14
  69 002a 0C20     		movs	r0, #12
  70              	.LVL2:
  71              		.loc 1 16 9 view .LVU15
  72 002c FFF7FEFF 		bl	malloc
  73              	.LVL3:
  17:Core/Src/hw_gpio.c **** 
  18:Core/Src/hw_gpio.c ****     /* Turn on ports clock if not already on. Find addr of reg based on char */
  19:Core/Src/hw_gpio.c ****     switch (gs->port)
  74              		.loc 1 19 5 is_stmt 1 view .LVU16
  75 0030 413D     		subs	r5, r5, #65
  76 0032 042D     		cmp	r5, #4
  77 0034 0BD8     		bhi	.L3
  78 0036 DFE805F0 		tbb	[pc, r5]
  79              	.L5:
  80 003a 03       		.byte	(.L9-.L5)/2
  81 003b 33       		.byte	(.L8-.L5)/2
  82 003c 3B       		.byte	(.L7-.L5)/2
  83 003d 43       		.byte	(.L6-.L5)/2
  84 003e 4B       		.byte	(.L4-.L5)/2
  85 003f 00       		.p2align 1
  86              	.L9:
  20:Core/Src/hw_gpio.c ****     {
  21:Core/Src/hw_gpio.c ****     case 'A':
  22:Core/Src/hw_gpio.c ****       RCC->APB2ENR |= RCC_APB2ENR_IOPAEN;
  87              		.loc 1 22 7 view .LVU17
  88              		.loc 1 22 20 is_stmt 0 view .LVU18
  89 0040 3C4A     		ldr	r2, .L16
  90 0042 9369     		ldr	r3, [r2, #24]
  91 0044 43F00403 		orr	r3, r3, #4
  92 0048 9361     		str	r3, [r2, #24]
  23:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOA;
ARM GAS  /tmp/ccr9mM5i.s 			page 3


  93              		.loc 1 23 7 is_stmt 1 view .LVU19
  94              		.loc 1 23 24 is_stmt 0 view .LVU20
  95 004a 3B4B     		ldr	r3, .L16+4
  96 004c 8360     		str	r3, [r0, #8]
  24:Core/Src/hw_gpio.c ****       break;
  97              		.loc 1 24 7 is_stmt 1 view .LVU21
  98              	.L3:
  25:Core/Src/hw_gpio.c ****     case 'B':
  26:Core/Src/hw_gpio.c ****       RCC->APB2ENR |= RCC_APB2ENR_IOPBEN;
  27:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOB;
  28:Core/Src/hw_gpio.c ****       break;
  29:Core/Src/hw_gpio.c ****     case 'C':
  30:Core/Src/hw_gpio.c ****       RCC->APB2ENR |= RCC_APB2ENR_IOPCEN;
  31:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOC;
  32:Core/Src/hw_gpio.c ****       break;
  33:Core/Src/hw_gpio.c ****     case 'D':
  34:Core/Src/hw_gpio.c ****       RCC->APB2ENR |= RCC_APB2ENR_IOPDEN;
  35:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOD;
  36:Core/Src/hw_gpio.c ****       break;
  37:Core/Src/hw_gpio.c ****     case 'E':
  38:Core/Src/hw_gpio.c ****       RCC->APB2ENR |= RCC_APB2ENR_IOPEEN;
  39:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOE;
  40:Core/Src/hw_gpio.c ****       break;
  41:Core/Src/hw_gpio.c ****     }
  42:Core/Src/hw_gpio.c **** 
  43:Core/Src/hw_gpio.c ****     /* copy across GPIO parameters */
  44:Core/Src/hw_gpio.c ****     g->dir = gs->dir;
  99              		.loc 1 44 5 view .LVU22
 100              		.loc 1 44 16 is_stmt 0 view .LVU23
 101 004e 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 102              		.loc 1 44 12 view .LVU24
 103 0050 4370     		strb	r3, [r0, #1]
  45:Core/Src/hw_gpio.c ****     g->cfg = gs->cfg;
 104              		.loc 1 45 5 is_stmt 1 view .LVU25
 105              		.loc 1 45 16 is_stmt 0 view .LVU26
 106 0052 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 107              		.loc 1 45 12 view .LVU27
 108 0054 8370     		strb	r3, [r0, #2]
  46:Core/Src/hw_gpio.c ****     g->pin = gs->pin;
 109              		.loc 1 46 5 is_stmt 1 view .LVU28
 110              		.loc 1 46 16 is_stmt 0 view .LVU29
 111 0056 E378     		ldrb	r3, [r4, #3]	@ zero_extendqisi2
 112              		.loc 1 46 12 view .LVU30
 113 0058 0371     		strb	r3, [r0, #4]
  47:Core/Src/hw_gpio.c ****     g->port = gs->port;
 114              		.loc 1 47 5 is_stmt 1 view .LVU31
 115              		.loc 1 47 17 is_stmt 0 view .LVU32
 116 005a A278     		ldrb	r2, [r4, #2]	@ zero_extendqisi2
 117              		.loc 1 47 13 view .LVU33
 118 005c C270     		strb	r2, [r0, #3]
  48:Core/Src/hw_gpio.c **** 
  49:Core/Src/hw_gpio.c ****     /* Assign low as default state */
  50:Core/Src/hw_gpio.c ****     g->state = PIN_LOW;
 119              		.loc 1 50 5 is_stmt 1 view .LVU34
 120              		.loc 1 50 14 is_stmt 0 view .LVU35
 121 005e 0022     		movs	r2, #0
 122 0060 0270     		strb	r2, [r0]
ARM GAS  /tmp/ccr9mM5i.s 			page 4


  51:Core/Src/hw_gpio.c **** 
  52:Core/Src/hw_gpio.c ****     /* Set registers based on GPIO settings */
  53:Core/Src/hw_gpio.c ****     if (g->pin < 8)
 123              		.loc 1 53 5 is_stmt 1 view .LVU36
 124              		.loc 1 53 8 is_stmt 0 view .LVU37
 125 0062 072B     		cmp	r3, #7
 126 0064 3CD8     		bhi	.L10
  54:Core/Src/hw_gpio.c ****     {
  55:Core/Src/hw_gpio.c ****       g->port_reg_addr->CRL &= ~(0x0F << (REG_PIN_CONF_BITLENGTH * g->pin));                       
 127              		.loc 1 55 7 is_stmt 1 view .LVU38
 128              		.loc 1 55 8 is_stmt 0 view .LVU39
 129 0066 8468     		ldr	r4, [r0, #8]
 130              	.LVL4:
 131              		.loc 1 55 29 view .LVU40
 132 0068 2268     		ldr	r2, [r4]
 133              		.loc 1 55 66 view .LVU41
 134 006a 9B00     		lsls	r3, r3, #2
 135              		.loc 1 55 39 view .LVU42
 136 006c 0F21     		movs	r1, #15
 137 006e 01FA03F3 		lsl	r3, r1, r3
 138              		.loc 1 55 29 view .LVU43
 139 0072 22EA0303 		bic	r3, r2, r3
 140 0076 2360     		str	r3, [r4]
  56:Core/Src/hw_gpio.c ****       g->port_reg_addr->CRL |= ((uint32_t)(g->dir)) << ((REG_PIN_CONF_BITLENGTH * g->pin) + REG_MOD
 141              		.loc 1 56 7 is_stmt 1 view .LVU44
 142              		.loc 1 56 8 is_stmt 0 view .LVU45
 143 0078 8468     		ldr	r4, [r0, #8]
 144              		.loc 1 56 29 view .LVU46
 145 007a 2368     		ldr	r3, [r4]
 146              		.loc 1 56 45 view .LVU47
 147 007c 4278     		ldrb	r2, [r0, #1]	@ zero_extendqisi2
 148              		.loc 1 56 84 view .LVU48
 149 007e 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
 150              		.loc 1 56 91 view .LVU49
 151 0080 8900     		lsls	r1, r1, #2
 152              		.loc 1 56 53 view .LVU50
 153 0082 8A40     		lsls	r2, r2, r1
 154              		.loc 1 56 29 view .LVU51
 155 0084 1343     		orrs	r3, r3, r2
 156 0086 2360     		str	r3, [r4]
  57:Core/Src/hw_gpio.c ****       g->port_reg_addr->CRL |= (((uint32_t)(g->cfg)) & ~(0x04)) << ((REG_PIN_CONF_BITLENGTH * g->pi
 157              		.loc 1 57 7 is_stmt 1 view .LVU52
 158              		.loc 1 57 8 is_stmt 0 view .LVU53
 159 0088 8468     		ldr	r4, [r0, #8]
 160              		.loc 1 57 29 view .LVU54
 161 008a 2168     		ldr	r1, [r4]
 162              		.loc 1 57 46 view .LVU55
 163 008c 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
 164              		.loc 1 57 54 view .LVU56
 165 008e 23F00403 		bic	r3, r3, #4
 166              		.loc 1 57 96 view .LVU57
 167 0092 0279     		ldrb	r2, [r0, #4]	@ zero_extendqisi2
 168              		.loc 1 57 93 view .LVU58
 169 0094 9200     		lsls	r2, r2, #2
 170              		.loc 1 57 103 view .LVU59
 171 0096 0232     		adds	r2, r2, #2
 172              		.loc 1 57 65 view .LVU60
ARM GAS  /tmp/ccr9mM5i.s 			page 5


 173 0098 9340     		lsls	r3, r3, r2
 174              		.loc 1 57 29 view .LVU61
 175 009a 0B43     		orrs	r3, r3, r1
 176 009c 2360     		str	r3, [r4]
 177 009e 42E0     		b	.L1
 178              	.LVL5:
 179              	.L8:
  26:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOB;
 180              		.loc 1 26 7 is_stmt 1 view .LVU62
  26:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOB;
 181              		.loc 1 26 20 is_stmt 0 view .LVU63
 182 00a0 244A     		ldr	r2, .L16
 183 00a2 9369     		ldr	r3, [r2, #24]
 184 00a4 43F00803 		orr	r3, r3, #8
 185 00a8 9361     		str	r3, [r2, #24]
  27:Core/Src/hw_gpio.c ****       break;
 186              		.loc 1 27 7 is_stmt 1 view .LVU64
  27:Core/Src/hw_gpio.c ****       break;
 187              		.loc 1 27 24 is_stmt 0 view .LVU65
 188 00aa 244B     		ldr	r3, .L16+8
 189 00ac 8360     		str	r3, [r0, #8]
  28:Core/Src/hw_gpio.c ****     case 'C':
 190              		.loc 1 28 7 is_stmt 1 view .LVU66
 191 00ae CEE7     		b	.L3
 192              	.L7:
  30:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOC;
 193              		.loc 1 30 7 view .LVU67
  30:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOC;
 194              		.loc 1 30 20 is_stmt 0 view .LVU68
 195 00b0 204A     		ldr	r2, .L16
 196 00b2 9369     		ldr	r3, [r2, #24]
 197 00b4 43F01003 		orr	r3, r3, #16
 198 00b8 9361     		str	r3, [r2, #24]
  31:Core/Src/hw_gpio.c ****       break;
 199              		.loc 1 31 7 is_stmt 1 view .LVU69
  31:Core/Src/hw_gpio.c ****       break;
 200              		.loc 1 31 24 is_stmt 0 view .LVU70
 201 00ba 214B     		ldr	r3, .L16+12
 202 00bc 8360     		str	r3, [r0, #8]
  32:Core/Src/hw_gpio.c ****     case 'D':
 203              		.loc 1 32 7 is_stmt 1 view .LVU71
 204 00be C6E7     		b	.L3
 205              	.L6:
  34:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOD;
 206              		.loc 1 34 7 view .LVU72
  34:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOD;
 207              		.loc 1 34 20 is_stmt 0 view .LVU73
 208 00c0 1C4A     		ldr	r2, .L16
 209 00c2 9369     		ldr	r3, [r2, #24]
 210 00c4 43F02003 		orr	r3, r3, #32
 211 00c8 9361     		str	r3, [r2, #24]
  35:Core/Src/hw_gpio.c ****       break;
 212              		.loc 1 35 7 is_stmt 1 view .LVU74
  35:Core/Src/hw_gpio.c ****       break;
 213              		.loc 1 35 24 is_stmt 0 view .LVU75
 214 00ca 1E4B     		ldr	r3, .L16+16
 215 00cc 8360     		str	r3, [r0, #8]
ARM GAS  /tmp/ccr9mM5i.s 			page 6


  36:Core/Src/hw_gpio.c ****     case 'E':
 216              		.loc 1 36 7 is_stmt 1 view .LVU76
 217 00ce BEE7     		b	.L3
 218              	.L4:
  38:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOE;
 219              		.loc 1 38 7 view .LVU77
  38:Core/Src/hw_gpio.c ****       g->port_reg_addr = GPIOE;
 220              		.loc 1 38 20 is_stmt 0 view .LVU78
 221 00d0 184A     		ldr	r2, .L16
 222 00d2 9369     		ldr	r3, [r2, #24]
 223 00d4 43F04003 		orr	r3, r3, #64
 224 00d8 9361     		str	r3, [r2, #24]
  39:Core/Src/hw_gpio.c ****       break;
 225              		.loc 1 39 7 is_stmt 1 view .LVU79
  39:Core/Src/hw_gpio.c ****       break;
 226              		.loc 1 39 24 is_stmt 0 view .LVU80
 227 00da 1B4B     		ldr	r3, .L16+20
 228 00dc 8360     		str	r3, [r0, #8]
  40:Core/Src/hw_gpio.c ****     }
 229              		.loc 1 40 7 is_stmt 1 view .LVU81
 230 00de B6E7     		b	.L3
 231              	.L10:
  58:Core/Src/hw_gpio.c ****     }
  59:Core/Src/hw_gpio.c ****     else
  60:Core/Src/hw_gpio.c ****     {
  61:Core/Src/hw_gpio.c ****       g->port_reg_addr->CRH &= ~(0x0F << (REG_PIN_CONF_BITLENGTH * (g->pin - 0x08)));              
 232              		.loc 1 61 7 view .LVU82
 233              		.loc 1 61 8 is_stmt 0 view .LVU83
 234 00e0 8468     		ldr	r4, [r0, #8]
 235              	.LVL6:
 236              		.loc 1 61 29 view .LVU84
 237 00e2 6268     		ldr	r2, [r4, #4]
 238              		.loc 1 61 76 view .LVU85
 239 00e4 083B     		subs	r3, r3, #8
 240              		.loc 1 61 66 view .LVU86
 241 00e6 9B00     		lsls	r3, r3, #2
 242              		.loc 1 61 39 view .LVU87
 243 00e8 0F21     		movs	r1, #15
 244 00ea 01FA03F3 		lsl	r3, r1, r3
 245              		.loc 1 61 29 view .LVU88
 246 00ee 22EA0303 		bic	r3, r2, r3
 247 00f2 6360     		str	r3, [r4, #4]
  62:Core/Src/hw_gpio.c ****       g->port_reg_addr->CRH |= ((uint32_t)(g->dir)) << ((REG_PIN_CONF_BITLENGTH * (g->pin - 0x08)) 
 248              		.loc 1 62 7 is_stmt 1 view .LVU89
 249              		.loc 1 62 8 is_stmt 0 view .LVU90
 250 00f4 8468     		ldr	r4, [r0, #8]
 251              		.loc 1 62 29 view .LVU91
 252 00f6 6268     		ldr	r2, [r4, #4]
 253              		.loc 1 62 45 view .LVU92
 254 00f8 4178     		ldrb	r1, [r0, #1]	@ zero_extendqisi2
 255              		.loc 1 62 85 view .LVU93
 256 00fa 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 257              		.loc 1 62 91 view .LVU94
 258 00fc 083B     		subs	r3, r3, #8
 259              		.loc 1 62 100 view .LVU95
 260 00fe 9B00     		lsls	r3, r3, #2
 261              		.loc 1 62 53 view .LVU96
ARM GAS  /tmp/ccr9mM5i.s 			page 7


 262 0100 01FA03F3 		lsl	r3, r1, r3
 263              		.loc 1 62 29 view .LVU97
 264 0104 1343     		orrs	r3, r3, r2
 265 0106 6360     		str	r3, [r4, #4]
  63:Core/Src/hw_gpio.c ****       g->port_reg_addr->CRH |= (((uint32_t)(g->cfg)) & ~(0x04)) << ((REG_PIN_CONF_BITLENGTH * (g->p
 266              		.loc 1 63 7 is_stmt 1 view .LVU98
 267              		.loc 1 63 8 is_stmt 0 view .LVU99
 268 0108 8468     		ldr	r4, [r0, #8]
 269              		.loc 1 63 29 view .LVU100
 270 010a 6168     		ldr	r1, [r4, #4]
 271              		.loc 1 63 46 view .LVU101
 272 010c 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
 273              		.loc 1 63 54 view .LVU102
 274 010e 23F00402 		bic	r2, r3, #4
 275              		.loc 1 63 97 view .LVU103
 276 0112 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 277              		.loc 1 63 103 view .LVU104
 278 0114 083B     		subs	r3, r3, #8
 279              		.loc 1 63 93 view .LVU105
 280 0116 9B00     		lsls	r3, r3, #2
 281              		.loc 1 63 112 view .LVU106
 282 0118 0233     		adds	r3, r3, #2
 283              		.loc 1 63 65 view .LVU107
 284 011a 02FA03F3 		lsl	r3, r2, r3
 285              		.loc 1 63 29 view .LVU108
 286 011e 0B43     		orrs	r3, r3, r1
 287 0120 6360     		str	r3, [r4, #4]
 288 0122 00E0     		b	.L1
 289              	.LVL7:
 290              	.L11:
  10:Core/Src/hw_gpio.c **** 
 291              		.loc 1 10 11 view .LVU109
 292 0124 0020     		movs	r0, #0
 293              	.LVL8:
 294              	.L1:
  64:Core/Src/hw_gpio.c ****     }
  65:Core/Src/hw_gpio.c ****   }
  66:Core/Src/hw_gpio.c **** 
  67:Core/Src/hw_gpio.c ****   /* return pointer to our newly created gpio configuration */
  68:Core/Src/hw_gpio.c ****   return g;
  69:Core/Src/hw_gpio.c **** }
 295              		.loc 1 69 1 view .LVU110
 296 0126 38BD     		pop	{r3, r4, r5, pc}
 297              	.LVL9:
 298              	.L12:
  10:Core/Src/hw_gpio.c **** 
 299              		.loc 1 10 11 view .LVU111
 300 0128 0020     		movs	r0, #0
 301              	.LVL10:
  10:Core/Src/hw_gpio.c **** 
 302              		.loc 1 10 11 view .LVU112
 303 012a FCE7     		b	.L1
 304              	.LVL11:
 305              	.L13:
  10:Core/Src/hw_gpio.c **** 
 306              		.loc 1 10 11 view .LVU113
 307 012c 0020     		movs	r0, #0
ARM GAS  /tmp/ccr9mM5i.s 			page 8


 308              	.LVL12:
  10:Core/Src/hw_gpio.c **** 
 309              		.loc 1 10 11 view .LVU114
 310 012e FAE7     		b	.L1
 311              	.LVL13:
 312              	.L14:
  10:Core/Src/hw_gpio.c **** 
 313              		.loc 1 10 11 view .LVU115
 314 0130 0020     		movs	r0, #0
 315              	.LVL14:
  68:Core/Src/hw_gpio.c **** }
 316              		.loc 1 68 3 is_stmt 1 view .LVU116
  68:Core/Src/hw_gpio.c **** }
 317              		.loc 1 68 10 is_stmt 0 view .LVU117
 318 0132 F8E7     		b	.L1
 319              	.L17:
 320              		.align	2
 321              	.L16:
 322 0134 00100240 		.word	1073876992
 323 0138 00080140 		.word	1073809408
 324 013c 000C0140 		.word	1073810432
 325 0140 00100140 		.word	1073811456
 326 0144 00140140 		.word	1073812480
 327 0148 00180140 		.word	1073813504
 328              		.cfi_endproc
 329              	.LFE65:
 331              		.section	.text.hw_gpio_free_memory,"ax",%progbits
 332              		.align	1
 333              		.global	hw_gpio_free_memory
 334              		.syntax unified
 335              		.thumb
 336              		.thumb_func
 338              	hw_gpio_free_memory:
 339              	.LVL15:
 340              	.LFB66:
  70:Core/Src/hw_gpio.c **** 
  71:Core/Src/hw_gpio.c **** void hw_gpio_free_memory(gpio_t *gpio)
  72:Core/Src/hw_gpio.c **** {
 341              		.loc 1 72 1 is_stmt 1 view -0
 342              		.cfi_startproc
 343              		@ args = 0, pretend = 0, frame = 0
 344              		@ frame_needed = 0, uses_anonymous_args = 0
 345              		.loc 1 72 1 is_stmt 0 view .LVU119
 346 0000 08B5     		push	{r3, lr}
 347              	.LCFI1:
 348              		.cfi_def_cfa_offset 8
 349              		.cfi_offset 3, -8
 350              		.cfi_offset 14, -4
  73:Core/Src/hw_gpio.c ****   /* Free memory */
  74:Core/Src/hw_gpio.c ****   free(gpio);
 351              		.loc 1 74 3 is_stmt 1 view .LVU120
 352 0002 FFF7FEFF 		bl	free
 353              	.LVL16:
  75:Core/Src/hw_gpio.c **** }
 354              		.loc 1 75 1 is_stmt 0 view .LVU121
 355 0006 08BD     		pop	{r3, pc}
 356              		.cfi_endproc
ARM GAS  /tmp/ccr9mM5i.s 			page 9


 357              	.LFE66:
 359              		.section	.text.hw_gpio_write,"ax",%progbits
 360              		.align	1
 361              		.global	hw_gpio_write
 362              		.syntax unified
 363              		.thumb
 364              		.thumb_func
 366              	hw_gpio_write:
 367              	.LVL17:
 368              	.LFB67:
  76:Core/Src/hw_gpio.c **** 
  77:Core/Src/hw_gpio.c **** void hw_gpio_write(gpio_t *gpio, gpio_state_t set_state)
  78:Core/Src/hw_gpio.c **** {
 369              		.loc 1 78 1 is_stmt 1 view -0
 370              		.cfi_startproc
 371              		@ args = 0, pretend = 0, frame = 0
 372              		@ frame_needed = 0, uses_anonymous_args = 0
 373              		@ link register save eliminated.
  79:Core/Src/hw_gpio.c ****   if (PIN_LOW == set_state) {
 374              		.loc 1 79 3 view .LVU123
 375              		.loc 1 79 6 is_stmt 0 view .LVU124
 376 0000 0A46     		mov	r2, r1
 377 0002 39B9     		cbnz	r1, .L21
  80:Core/Src/hw_gpio.c ****     hw_gpio_reset(gpio);
 378              		.loc 1 80 5 is_stmt 1 view .LVU125
 379              	.LVL18:
 380              	.LBB6:
 381              	.LBI6:
  81:Core/Src/hw_gpio.c ****   }
  82:Core/Src/hw_gpio.c ****   if (PIN_HIGH == set_state) {
  83:Core/Src/hw_gpio.c ****     hw_gpio_set(gpio);
  84:Core/Src/hw_gpio.c ****   }
  85:Core/Src/hw_gpio.c **** }
  86:Core/Src/hw_gpio.c **** 
  87:Core/Src/hw_gpio.c **** inline void hw_gpio_set(gpio_t *gpio)
  88:Core/Src/hw_gpio.c **** {
  89:Core/Src/hw_gpio.c ****     gpio->state = PIN_HIGH;
  90:Core/Src/hw_gpio.c ****     gpio->port_reg_addr->BSRR = (0x01 << (uint8_t)(gpio->pin));
  91:Core/Src/hw_gpio.c **** }
  92:Core/Src/hw_gpio.c **** 
  93:Core/Src/hw_gpio.c **** inline void hw_gpio_reset(gpio_t *gpio)
 382              		.loc 1 93 13 view .LVU126
 383              	.LBB7:
  94:Core/Src/hw_gpio.c **** {
  95:Core/Src/hw_gpio.c ****     gpio->state = PIN_LOW;
 384              		.loc 1 95 5 view .LVU127
 385              		.loc 1 95 17 is_stmt 0 view .LVU128
 386 0004 0023     		movs	r3, #0
 387 0006 0370     		strb	r3, [r0]
  96:Core/Src/hw_gpio.c ****     gpio->port_reg_addr->BSRR = (0x01 << (uint8_t)(gpio->pin) << 0x10);
 388              		.loc 1 96 5 is_stmt 1 view .LVU129
 389              		.loc 1 96 56 is_stmt 0 view .LVU130
 390 0008 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
 391              	.LVL19:
 392              		.loc 1 96 39 view .LVU131
 393 000a 0123     		movs	r3, #1
 394 000c 8B40     		lsls	r3, r3, r1
ARM GAS  /tmp/ccr9mM5i.s 			page 10


 395              		.loc 1 96 9 view .LVU132
 396 000e 8168     		ldr	r1, [r0, #8]
 397              		.loc 1 96 63 view .LVU133
 398 0010 1B04     		lsls	r3, r3, #16
 399              		.loc 1 96 31 view .LVU134
 400 0012 0B61     		str	r3, [r1, #16]
 401              	.LVL20:
 402              	.L21:
 403              		.loc 1 96 31 view .LVU135
 404              	.LBE7:
 405              	.LBE6:
  82:Core/Src/hw_gpio.c ****     hw_gpio_set(gpio);
 406              		.loc 1 82 3 is_stmt 1 view .LVU136
  82:Core/Src/hw_gpio.c ****     hw_gpio_set(gpio);
 407              		.loc 1 82 6 is_stmt 0 view .LVU137
 408 0014 012A     		cmp	r2, #1
 409 0016 00D0     		beq	.L23
 410              	.L20:
  85:Core/Src/hw_gpio.c **** 
 411              		.loc 1 85 1 view .LVU138
 412 0018 7047     		bx	lr
 413              	.L23:
  83:Core/Src/hw_gpio.c ****   }
 414              		.loc 1 83 5 is_stmt 1 view .LVU139
 415              	.LVL21:
 416              	.LBB8:
 417              	.LBI8:
  87:Core/Src/hw_gpio.c **** {
 418              		.loc 1 87 13 view .LVU140
 419              	.LBB9:
  89:Core/Src/hw_gpio.c ****     gpio->port_reg_addr->BSRR = (0x01 << (uint8_t)(gpio->pin));
 420              		.loc 1 89 5 view .LVU141
  89:Core/Src/hw_gpio.c ****     gpio->port_reg_addr->BSRR = (0x01 << (uint8_t)(gpio->pin));
 421              		.loc 1 89 17 is_stmt 0 view .LVU142
 422 001a 0123     		movs	r3, #1
 423 001c 0370     		strb	r3, [r0]
  90:Core/Src/hw_gpio.c **** }
 424              		.loc 1 90 5 is_stmt 1 view .LVU143
  90:Core/Src/hw_gpio.c **** }
 425              		.loc 1 90 56 is_stmt 0 view .LVU144
 426 001e 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
  90:Core/Src/hw_gpio.c **** }
 427              		.loc 1 90 9 view .LVU145
 428 0020 8268     		ldr	r2, [r0, #8]
  90:Core/Src/hw_gpio.c **** }
 429              		.loc 1 90 39 view .LVU146
 430 0022 8B40     		lsls	r3, r3, r1
  90:Core/Src/hw_gpio.c **** }
 431              		.loc 1 90 31 view .LVU147
 432 0024 1361     		str	r3, [r2, #16]
 433              	.LVL22:
  90:Core/Src/hw_gpio.c **** }
 434              		.loc 1 90 31 view .LVU148
 435              	.LBE9:
 436              	.LBE8:
  85:Core/Src/hw_gpio.c **** 
 437              		.loc 1 85 1 view .LVU149
ARM GAS  /tmp/ccr9mM5i.s 			page 11


 438 0026 F7E7     		b	.L20
 439              		.cfi_endproc
 440              	.LFE67:
 442              		.section	.text.hw_gpio_read,"ax",%progbits
 443              		.align	1
 444              		.global	hw_gpio_read
 445              		.syntax unified
 446              		.thumb
 447              		.thumb_func
 449              	hw_gpio_read:
 450              	.LVL23:
 451              	.LFB70:
  97:Core/Src/hw_gpio.c **** }
  98:Core/Src/hw_gpio.c **** 
  99:Core/Src/hw_gpio.c **** gpio_state_t hw_gpio_read(gpio_t *gpio)
 100:Core/Src/hw_gpio.c **** {
 452              		.loc 1 100 1 is_stmt 1 view -0
 453              		.cfi_startproc
 454              		@ args = 0, pretend = 0, frame = 0
 455              		@ frame_needed = 0, uses_anonymous_args = 0
 456              		@ link register save eliminated.
 457              		.loc 1 100 1 is_stmt 0 view .LVU151
 458 0000 0346     		mov	r3, r0
 101:Core/Src/hw_gpio.c ****   /* retrieve the GPIO state on function call */
 102:Core/Src/hw_gpio.c ****   gpio->state = (gpio_state_t)((gpio->port_reg_addr->IDR) & (0x01 << gpio->pin));
 459              		.loc 1 102 3 is_stmt 1 view .LVU152
 460              		.loc 1 102 37 is_stmt 0 view .LVU153
 461 0002 8268     		ldr	r2, [r0, #8]
 462              		.loc 1 102 52 view .LVU154
 463 0004 9268     		ldr	r2, [r2, #8]
 464              		.loc 1 102 74 view .LVU155
 465 0006 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
 466              		.loc 1 102 67 view .LVU156
 467 0008 0120     		movs	r0, #1
 468              	.LVL24:
 469              		.loc 1 102 67 view .LVU157
 470 000a 8840     		lsls	r0, r0, r1
 471              		.loc 1 102 17 view .LVU158
 472 000c C0B2     		uxtb	r0, r0
 473              		.loc 1 102 59 view .LVU159
 474 000e 1040     		ands	r0, r0, r2
 475              		.loc 1 102 15 view .LVU160
 476 0010 1870     		strb	r0, [r3]
 103:Core/Src/hw_gpio.c ****   return gpio->state; 
 477              		.loc 1 103 3 is_stmt 1 view .LVU161
 104:Core/Src/hw_gpio.c **** }...
 478              		.loc 1 104 1 is_stmt 0 view .LVU162
 479 0012 7047     		bx	lr
 480              		.cfi_endproc
 481              	.LFE70:
 483              		.text
 484              	.Letext0:
 485              		.file 2 "/home/callum/.config/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tools/arm-no
 486              		.file 3 "/home/callum/.config/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tools/arm-no
 487              		.file 4 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/stm32f103xb.h"
 488              		.file 5 "Core/Inc/hw_gpio.h"
 489              		.file 6 "/home/callum/.config/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tools/arm-no
ARM GAS  /tmp/ccr9mM5i.s 			page 12


ARM GAS  /tmp/ccr9mM5i.s 			page 13


DEFINED SYMBOLS
                            *ABS*:0000000000000000 hw_gpio.c
     /tmp/ccr9mM5i.s:18     .text.hw_gpio_setup_gpio:0000000000000000 $t
     /tmp/ccr9mM5i.s:24     .text.hw_gpio_setup_gpio:0000000000000000 hw_gpio_setup_gpio
     /tmp/ccr9mM5i.s:80     .text.hw_gpio_setup_gpio:000000000000003a $d
     /tmp/ccr9mM5i.s:322    .text.hw_gpio_setup_gpio:0000000000000134 $d
     /tmp/ccr9mM5i.s:332    .text.hw_gpio_free_memory:0000000000000000 $t
     /tmp/ccr9mM5i.s:338    .text.hw_gpio_free_memory:0000000000000000 hw_gpio_free_memory
     /tmp/ccr9mM5i.s:360    .text.hw_gpio_write:0000000000000000 $t
     /tmp/ccr9mM5i.s:366    .text.hw_gpio_write:0000000000000000 hw_gpio_write
     /tmp/ccr9mM5i.s:443    .text.hw_gpio_read:0000000000000000 $t
     /tmp/ccr9mM5i.s:449    .text.hw_gpio_read:0000000000000000 hw_gpio_read
     /tmp/ccr9mM5i.s:85     .text.hw_gpio_setup_gpio:000000000000003f $d
     /tmp/ccr9mM5i.s:85     .text.hw_gpio_setup_gpio:0000000000000040 $t

UNDEFINED SYMBOLS
malloc
free
